{"version":3,"sources":["webpack:///./src/pages/implementation/workflow-execution.vue?651c","webpack:///./src/pages/util/event.js","webpack:///./src/pages/implementation/mockData.js","webpack:///src/pages/implementation/workflow-execution.vue","webpack:///./src/pages/implementation/workflow-execution.vue?80cb","webpack:///./src/pages/implementation/workflow-execution.vue","webpack:///./src/pages/implementation/workflow-execution.vue?55e4"],"names":["content","module","i","locals","exports","add","default","addEvent","selector","type","fn","nodesEl","document","querySelectorAll","length","node","removeEventListener","addEventListener","removeEvent","modelData","id","srcGraphNodeIds","succeedingNodeIds","refFlowNodeIds","data","graph","flowGraph","flowData","allFlows","allTarget","currentFlowNodeId","foundRefAry","selectedFlow","selectedTarget","showExcution","isShowBody","isEnqueryPage","mounted","this","getSelectionData","getAllFlow","methods","orchestrationSelectHandler","getFlowOutlineData","queryHandler","$nextTick","createHandler","createFlowHandler","console","log","getModelData","initModelGraph","renderModelGraph","_","current","map","to","pathAry","push","graphviz","renderDot","nodesString","fit","renderFlowGraph","Completed","deployed","InProgress","Faulted","Timeouted","nodeType","excution","statusColor","status","bindFlowEvent","excutionFlow","flowNodes","forEach","setTimeout","index","e","preventDefault","stopPropagation","highlightModel","find","item","modelClickHandler","flowNodeIndex","foundModelNode","splice","getElementById","innerHTML","on","initEvent","initFlowGraph","render","_vm","_h","$createElement","_c","_self","attrs","$t","staticStyle","model","value","callback","$$v","expression","_l","key","procDefId","_v","_s","procDefName","procDefVersion","timestamp","createBy","regx","staticClass","_e","staticRenderFns","injectStyle","context","__vue_template_functional__","__vue_styles__","__vue_scopeId__","__vue_module_identifier__","Component"],"mappings":"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","file":"js/chunk-de9ee160.0e64c68d.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-94226cfe\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../../node_modules/sass-loader/lib/loader.js!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./workflow-execution.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-loader/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"3143c845\", content, true, {});","export const addEvent = (selector, type, fn) => {\n  let nodesEl = document.querySelectorAll(selector);\n  let length = nodesEl.length;\n  // const func = e => {\n  //   fn(e);\n  // };\n  for (let i = 0; i < length; i++) {\n    let node = nodesEl[i];\n    node.removeEventListener(type, fn);\n    node.addEventListener(type, fn);\n  }\n};\nexport const removeEvent = (selector, type, fn) => {\n  let nodesEl = document.querySelectorAll(selector);\n  let length = nodesEl.length;\n  // const func = e => {\n  //   fn(e);\n  // };\n  for (let i = 0; i < length; i++) {\n    let node = nodesEl[i];\n    node.removeEventListener(type, fn);\n  }\n};\n","export const modelData = [\n  {\n    id: \"UNIT_APP\",\n    srcGraphNodeIds: [],\n    succeedingNodeIds: [\"INS1\", \"INS2\", \"PACK_V1\"],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"INS1\",\n    srcGraphNodeIds: [\"UNIT_APP\"],\n    succeedingNodeIds: [\"HOST1\", \"PACK_V1\"],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"HOST1\",\n    srcGraphNodeIds: [\"INS1\"],\n    succeedingNodeIds: [\"DISK1\", \"IP1\"],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"DISK1\",\n    srcGraphNodeIds: [\"HOST1\"],\n    succeedingNodeIds: [],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"IP1\",\n    srcGraphNodeIds: [\"HOST1\"],\n    succeedingNodeIds: [],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"PACK_V1\",\n    srcGraphNodeIds: [\"INS1\", \"UNIT_APP\", \"INS2\"],\n    succeedingNodeIds: [\"USER\"],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"USER\",\n    srcGraphNodeIds: [\"PACK_V1\"],\n    succeedingNodeIds: [],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"INS2\",\n    srcGraphNodeIds: [\"UNIT_APP\"],\n    succeedingNodeIds: [\"HOST2\", \"PACK_V1\"],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"HOST2\",\n    srcGraphNodeIds: [\"INS2\"],\n    succeedingNodeIds: [\"IP2\", \"DISK2\"],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"IP2\",\n    srcGraphNodeIds: [\"HOST2\"],\n    succeedingNodeIds: [],\n    refFlowNodeIds: []\n  },\n  {\n    id: \"DISK2\",\n    srcGraphNodeIds: [\"HOST2\"],\n    succeedingNodeIds: [],\n    refFlowNodeIds: []\n  }\n];\n","<template>\n  <div>\n    <Card dis-hover>\n      <Row>\n        <Col span=\"20\">\n          <Form label-position=\"left\">\n            <FormItem :label-width=\"150\" :label=\"$t('orchs')\">\n              <Select label v-model=\"selectedFlow\" style=\"width:70%\" clearable>\n                <Option\n                  v-for=\"item in allFlows\"\n                  :value=\"item.procDefId\"\n                  :key=\"item.procDefId\"\n                >\n                  {{\n                    item.procDefName +\n                      \" version_\" +\n                      item.procDefVersion +\n                      \" \" +\n                      (item.timestamp || \"timestap\") +\n                      \" \" +\n                      (item.createBy || \"createBy\")\n                  }}\n                </Option>\n              </Select>\n              <Button type=\"info\" @click=\"queryHandler\">\n                {{ $t(\"query_orch\") }}\n              </Button>\n              <Button type=\"success\" @click=\"createHandler\">\n                {{ $t(\"create_orch\") }}\n              </Button>\n            </FormItem>\n          </Form>\n        </Col>\n      </Row>\n      <Row\n        v-if=\"isShowBody\"\n        style=\"border:1px solid #ebe7e7;border-radius:3px; padding:20px\"\n      >\n        <Row>\n          <Form>\n            <Col span=\"6\">\n              <FormItem :label-width=\"100\" :label=\"$t('select_orch')\">\n                <Select\n                  label\n                  v-model=\"selectedFlow\"\n                  :disabled=\"isEnqueryPage\"\n                  @on-change=\"orchestrationSelectHandler\"\n                >\n                  <Option\n                    v-for=\"item in allFlows\"\n                    :value=\"item.procDefId\"\n                    :key=\"item.procDefId\"\n                  >\n                    {{ item.procDefName }}\n                  </Option>\n                </Select>\n              </FormItem>\n            </Col>\n            <Col span=\"8\">\n              <FormItem :label-width=\"100\" :label=\"$t('target_object')\">\n                <Select\n                  label\n                  v-model=\"selectedTarget\"\n                  :disabled=\"isEnqueryPage\"\n                  @on-change=\"createFlowHandler\"\n                >\n                  <Option\n                    v-for=\"item in allTarget\"\n                    :value=\"item.id\"\n                    :key=\"item.id\"\n                    >{{ item.regx }}</Option\n                  >\n                </Select>\n              </FormItem>\n            </Col>\n          </Form>\n        </Row>\n        <Row style=\"border:1px solid #d3cece;border-radius:3px; padding:20px\">\n          <Col\n            span=\"6\"\n            style=\"border-right:1px solid #d3cece; text-align: center\"\n          >\n            <div class=\"graph-container\" id=\"flow\"></div>\n          </Col>\n          <Col\n            span=\"18\"\n            style=\"text-align: center;margin-top: 60px;text-align: center\"\n          >\n            <div class=\"graph-container\" id=\"graph\"></div>\n            <div style=\"text-align: center;margin-top: 60px;\">\n              <Button v-if=\"showExcution\" type=\"info\" @click=\"excutionFlow\">\n                {{ $t(\"execute\") }}\n              </Button>\n            </div>\n          </Col>\n        </Row>\n      </Row>\n    </Card>\n  </div>\n</template>\n<script>\nimport { getAllFlow, getFlowOutlineByID } from \"@/api/server\";\nimport * as d3 from \"d3-selection\";\nimport * as d3Graphviz from \"d3-graphviz\";\nimport { addEvent, removeEvent } from \"../util/event.js\";\nimport { modelData } from \"./mockData\";\nexport default {\n  data() {\n    return {\n      graph: {},\n      flowGraph: {},\n      modelData,\n      flowData: {},\n      allFlows: [],\n      allTarget: [],\n      currentFlowNodeId: \"\",\n      foundRefAry: [],\n      selectedFlow: \"\",\n      selectedTarget: \"\",\n      showExcution: true,\n      isShowBody: false,\n      isEnqueryPage: false\n    };\n  },\n  mounted() {\n    this.getSelectionData();\n    this.getAllFlow();\n  },\n  methods: {\n    async getAllFlow() {\n      let { status, data, message } = await getAllFlow(false);\n      if (status === \"OK\") {\n        this.allFlows = data;\n      }\n    },\n    getSelectionData() {\n      this.allTarget = [\n        { id: 1, regx: \"A-B.c\" },\n        { id: 2, regx: \"D-C.c\" }\n      ];\n    },\n    orchestrationSelectHandler() {\n      this.getFlowOutlineData();\n    },\n    queryHandler() {\n      if (!this.selectedFlow) return;\n      this.isShowBody = true;\n      this.isEnqueryPage = true;\n      this.$nextTick(() => {\n        this.getModelData();\n        this.getFlowOutlineData();\n      });\n    },\n    createHandler() {\n      this.isShowBody = true;\n      this.isEnqueryPage = false;\n      this.selectedTarget = \"\";\n      this.selectedFlow = \"\";\n    },\n    createFlowHandler() {\n      console.log(\"selectedTarget is: \", this.selectedTarget);\n      this.getModelData();\n    },\n    getModelData() {\n      // let { status, data, message } = await xxxx();\n      this.initModelGraph();\n    },\n    async getFlowOutlineData() {\n      let { status, data, message } = await getFlowOutlineByID(\n        this.selectedFlow\n      );\n      if (status === \"OK\") {\n        this.flowData = data;\n        this.initFlowGraph();\n      }\n    },\n    renderModelGraph() {\n      let nodes = this.modelData.map((_, index) => {\n        let color = _.isHighlight ? \"#5DB400\" : \"black\";\n        const isRecord = _.refFlowNodeIds.length > 0;\n        const shape = isRecord ? \"Mrecord\" : \"ellipse\";\n        const label =\n          _.refFlowNodeIds.toString().replace(/,/g, \"/\") +\n          (isRecord ? \"|\" : \"\") +\n          _.id;\n        return `${_.id} [label=\"${label}\" class=\"model\" id=\"${_.id}\" color=\"${color}\" shape=\"${shape}\" ]`;\n      });\n      let genEdge = () => {\n        let pathAry = [];\n        this.modelData.forEach(_ => {\n          if (_.succeedingNodeIds.length > 0) {\n            let current = [];\n            current = _.succeedingNodeIds.map(to => {\n              return _.id + \" -> \" + to;\n            });\n            pathAry.push(current);\n          }\n        });\n        return pathAry\n          .flat()\n          .toString()\n          .replace(/,/g, \";\");\n      };\n      let nodesString =\n        \"digraph G { \" +\n        'bgcolor=\"transparent\";' +\n        'Node [fontname=Arial, shape=\"ellipse\", fixedsize=\"true\", width=\"1.6\", height=\".8\",fontsize=12];' +\n        'Edge [fontname=Arial, minlen=\"1\", color=\"#7f8fa6\", fontsize=10];' +\n        nodes.toString().replace(/,/g, \"; \") +\n        \";\" +\n        genEdge() +\n        \"}\";\n      this.graph.graphviz.renderDot(nodesString).fit(true);\n    },\n    renderFlowGraph(excution) {\n      const statusColor = {\n        Completed: \"#5DB400\",\n        deployed: \"#7F8A96\",\n        InProgress: \"#3C83F8\",\n        Faulted: \"#FF6262\",\n        Timeouted: \"#F7B500\"\n      };\n      let nodes = this.flowData.flowNodes.map((_, index) => {\n        if (_.nodeType === \"startEvent\" || _.nodeType === \"endEvent\") {\n          return `${_.nodeId} [label=\"${\n            _.nodeName\n          }\", fontsize=\"10\", class=\"flow\",style=\"${\n            excution ? \"filled\" : \"none\"\n          }\" color=\"${\n            excution ? statusColor[_.status] : \"#7F8A96\"\n          }\" shape=\"circle\", id=\"${_.nodeId}\"]`;\n        } else {\n          console.log(111, excution, statusColor[_.status], _.status);\n          return `${_.nodeId} [label=\"${_.orderedNo +\n            \"、\" +\n            _.nodeName}\" fontsize=\"10\" class=\"flow\" style=\"${\n            excution ? \"filled\" : \"none\"\n          }\" color=\"${\n            excution\n              ? statusColor[_.status]\n              : _.nodeId === this.currentFlowNodeId\n              ? \"#5DB400\"\n              : \"#7F8A96\"\n          }\"  shape=\"record\" id=\"${_.nodeId}\"] height=.2`;\n        }\n      });\n      let genEdge = () => {\n        let pathAry = [];\n        this.flowData.flowNodes.forEach(_ => {\n          if (_.succeedingNodeIds.length > 0) {\n            let current = [];\n            current = _.succeedingNodeIds.map(to => {\n              return (\n                _.nodeId +\n                \" -> \" +\n                `${to} [color=\"${excution ? statusColor[_.status] : \"black\"}\"]`\n              );\n            });\n            pathAry.push(current);\n          }\n        });\n        return pathAry\n          .flat()\n          .toString()\n          .replace(/,/g, \";\");\n      };\n      let nodesString =\n        \"digraph G {\" +\n        'bgcolor=\"transparent\";' +\n        'Node [fontname=Arial, height=\".3\", fontsize=12];' +\n        'Edge [fontname=Arial, color=\"#7f8fa6\", fontsize=10];' +\n        nodes.toString().replace(/,/g, \";\") +\n        \";\" +\n        genEdge() +\n        \"}\";\n      this.flowGraph.graphviz.renderDot(nodesString).fit(true);\n      this.bindFlowEvent();\n    },\n    excutionFlow() {\n      if (!this.isEnqueryPage) {\n        this.selectedFlow = 1;\n      }\n      this.showExcution = false;\n      this.isEnqueryPage = true;\n      this.flowData.flowNodes.forEach((_, index) => {\n        setTimeout(() => {\n          if (index > 0) {\n            this.flowData.flowNodes[index - 1].status = \"Completed\";\n          }\n          _.status = \"InProgress\";\n          this.renderFlowGraph(true);\n        }, 3000 * index);\n      });\n    },\n    bindFlowEvent() {\n      if (this.isEnqueryPage !== true) {\n        addEvent(\".flow\", \"mouseover\", e => {\n          e.preventDefault();\n          e.stopPropagation();\n          d3.selectAll(\"g\").attr(\"cursor\", \"pointer\");\n        });\n        addEvent(\".flow\", \"click\", e => {\n          e.preventDefault();\n          e.stopPropagation();\n          let g = e.currentTarget;\n          this.highlightModel(g.id);\n          this.currentFlowNodeId = g.id;\n          this.renderFlowGraph();\n        });\n      }\n    },\n    highlightModel(nodeId) {\n      this.foundRefAry = this.flowData.flowNodes.find(\n        item => item.nodeId == nodeId\n      ).previousNodeIds;\n      this.modelData.forEach(item => {\n        item[\"isHighlight\"] = this.foundRefAry.includes(item.nodeId);\n      });\n      this.renderModelGraph();\n      removeEvent(\".model\", \"click\", this.modelClickHandler);\n      this.foundRefAry.forEach(_ => {\n        addEvent(`#${_}`, \"click\", this.modelClickHandler);\n      });\n    },\n    modelClickHandler(e) {\n      e.preventDefault();\n      e.stopPropagation();\n      let g = e.currentTarget;\n      let foundModelNode = this.modelData.find(_ => _.id == g.id);\n      const flowNodeIndex = foundModelNode.refFlowNodeIds.indexOf(\n        this.currentFlowNodeId\n      );\n      if (flowNodeIndex > -1) {\n        foundModelNode.refFlowNodeIds.splice(flowNodeIndex, 1);\n      } else {\n        foundModelNode.refFlowNodeIds.push(this.currentFlowNodeId);\n      }\n      document.getElementById(\"graph\").innerHTML = \"\";\n      this.renderModelGraph();\n      this.foundRefAry.forEach(_ => {\n        addEvent(`#${_}`, \"click\", this.modelClickHandler);\n      });\n    },\n    initModelGraph() {\n      const initEvent = () => {\n        let graph;\n        graph = d3.select(`#graph`);\n        graph.on(\"dblclick.zoom\", null);\n        this.graph.graphviz = graph.graphviz().zoom(false);\n      };\n      initEvent();\n      this.renderModelGraph();\n    },\n    initFlowGraph() {\n      const initEvent = () => {\n        let graph;\n        graph = d3.select(`#flow`);\n        graph.on(\"dblclick.zoom\", null);\n        this.flowGraph.graphviz = graph.graphviz().zoom(false);\n      };\n      initEvent();\n      this.renderFlowGraph();\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\nbody {\n  color: #15a043;\n}\n</style>\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Card',{attrs:{\"dis-hover\":\"\"}},[_c('Row',[_c('Col',{attrs:{\"span\":\"20\"}},[_c('Form',{attrs:{\"label-position\":\"left\"}},[_c('FormItem',{attrs:{\"label-width\":150,\"label\":_vm.$t('orchs')}},[_c('Select',{staticStyle:{\"width\":\"70%\"},attrs:{\"label\":\"\",\"clearable\":\"\"},model:{value:(_vm.selectedFlow),callback:function ($$v) {_vm.selectedFlow=$$v},expression:\"selectedFlow\"}},_vm._l((_vm.allFlows),function(item){return _c('Option',{key:item.procDefId,attrs:{\"value\":item.procDefId}},[_vm._v(\"\\n                \"+_vm._s(item.procDefName +\n                    \" version_\" +\n                    item.procDefVersion +\n                    \" \" +\n                    (item.timestamp || \"timestap\") +\n                    \" \" +\n                    (item.createBy || \"createBy\"))+\"\\n              \")])}),1),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.queryHandler}},[_vm._v(\"\\n              \"+_vm._s(_vm.$t(\"query_orch\"))+\"\\n            \")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"success\"},on:{\"click\":_vm.createHandler}},[_vm._v(\"\\n              \"+_vm._s(_vm.$t(\"create_orch\"))+\"\\n            \")])],1)],1)],1)],1),_vm._v(\" \"),(_vm.isShowBody)?_c('Row',{staticStyle:{\"border\":\"1px solid #ebe7e7\",\"border-radius\":\"3px\",\"padding\":\"20px\"}},[_c('Row',[_c('Form',[_c('Col',{attrs:{\"span\":\"6\"}},[_c('FormItem',{attrs:{\"label-width\":100,\"label\":_vm.$t('select_orch')}},[_c('Select',{attrs:{\"label\":\"\",\"disabled\":_vm.isEnqueryPage},on:{\"on-change\":_vm.orchestrationSelectHandler},model:{value:(_vm.selectedFlow),callback:function ($$v) {_vm.selectedFlow=$$v},expression:\"selectedFlow\"}},_vm._l((_vm.allFlows),function(item){return _c('Option',{key:item.procDefId,attrs:{\"value\":item.procDefId}},[_vm._v(\"\\n                  \"+_vm._s(item.procDefName)+\"\\n                \")])}),1)],1)],1),_vm._v(\" \"),_c('Col',{attrs:{\"span\":\"8\"}},[_c('FormItem',{attrs:{\"label-width\":100,\"label\":_vm.$t('target_object')}},[_c('Select',{attrs:{\"label\":\"\",\"disabled\":_vm.isEnqueryPage},on:{\"on-change\":_vm.createFlowHandler},model:{value:(_vm.selectedTarget),callback:function ($$v) {_vm.selectedTarget=$$v},expression:\"selectedTarget\"}},_vm._l((_vm.allTarget),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(_vm._s(item.regx))])}),1)],1)],1)],1)],1),_vm._v(\" \"),_c('Row',{staticStyle:{\"border\":\"1px solid #d3cece\",\"border-radius\":\"3px\",\"padding\":\"20px\"}},[_c('Col',{staticStyle:{\"border-right\":\"1px solid #d3cece\",\"text-align\":\"center\"},attrs:{\"span\":\"6\"}},[_c('div',{staticClass:\"graph-container\",attrs:{\"id\":\"flow\"}})]),_vm._v(\" \"),_c('Col',{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"60px\"},attrs:{\"span\":\"18\"}},[_c('div',{staticClass:\"graph-container\",attrs:{\"id\":\"graph\"}}),_vm._v(\" \"),_c('div',{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"60px\"}},[(_vm.showExcution)?_c('Button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.excutionFlow}},[_vm._v(\"\\n              \"+_vm._s(_vm.$t(\"execute\"))+\"\\n            \")]):_vm._e()],1)])],1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }","function injectStyle (context) {\n  require(\"!!vue-loader/node_modules/vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-94226cfe\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!sass-loader!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./workflow-execution.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./workflow-execution.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./workflow-execution.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-94226cfe\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./workflow-execution.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-94226cfe\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"body[data-v-94226cfe]{color:#15a043}\", \"\"]);\n\n// exports\n"],"sourceRoot":""}