{"version":3,"sources":["webpack:///./src/pages/admin/user-role-management.vue?5aac","webpack:///./src/pages/admin/user-role-management.vue?f34a","webpack:///src/pages/admin/user-role-management.vue","webpack:///./src/pages/admin/user-role-management.vue?b175","webpack:///./src/pages/admin/user-role-management.vue"],"names":["content","module","i","locals","exports","add","default","push","data","users","roles","addedUser","addedRole","addedRoleValue","transferTitles","this","$t","transferStyle","usersKeyBySelectedRole","allUsersForTransfer","addUserModalVisible","addRoleModalVisible","userManageModal","originMenus","menus","methods","menusPermissionSelected","allMenus","forEach","_","children","m","checked","subMenu","indeterminate","menusResponseHandeler","category","title","id","expand","disabled","h","renderUserNameForTransfer","item","label","confirmUser","currentRoleId","handleRoleClick","openAddRoleModal","openAddUserModal","cancel","created","getAllUsers","getAllRoles","getAllMenus","render","_vm","_h","$createElement","_c","_self","attrs","slot","_v","_s","on","_l","key","username","color","handleUserClick","staticClass","displayName","$event","openUserManageModal","handleMenuTreeCheck","addUser","model","value","callback","$$v","expression","ref","$set","addRole","handleUserTransferChange","staticRenderFns","injectStyle","context","__vue_template_functional__","__vue_styles__","__vue_scopeId__","__vue_module_identifier__","Component"],"mappings":"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","file":"js/chunk-664494f9.692a8299.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-62d6cfa0\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../../node_modules/sass-loader/lib/loader.js!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./user-role-management.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-loader/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"349371d5\", content, true, {});","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".ivu-tag[data-v-62d6cfa0]{display:block;border:1px dashed #515a61!important}.ivu-tag .ivu-tag-text[data-v-62d6cfa0]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.role-item .ivu-tag[data-v-62d6cfa0]{display:inline-block;width:65%}.data-permissions[data-v-62d6cfa0]{width:100%;height:30px;border:1px dashed gray;padding-left:5px;padding-right:5px;border-radius:5px;margin-bottom:5px}.ciTypes-options[data-v-62d6cfa0]{float:right;line-height:30px}.ciTypes[data-v-62d6cfa0]{float:left;line-height:30px}.ciTypes-options .ivu-checkbox-indeterminate .ivu-checkbox-inner[data-v-62d6cfa0]{background-color:#4ee643}.ciTypes-options .ivu-checkbox-disabled.ivu-checkbox-checked .ivu-checkbox-inner[data-v-62d6cfa0]{background-color:#2d8cf0}\", \"\"]);\n\n// exports\n","<template>\n  <div>\n    <Row>\n      <Col span=\"7\">\n        <Card>\n          <p slot=\"title\">\n            {{ $t(\"user\") }}\n            <Button\n              icon=\"ios-add\"\n              type=\"dashed\"\n              size=\"small\"\n              @click=\"openAddUserModal\"\n              >{{ $t(\"add_user\") }}</Button\n            >\n          </p>\n          <Tag\n            v-for=\"item in users\"\n            :key=\"item.id\"\n            :name=\"item.username\"\n            :color=\"item.color\"\n            :checked=\"item.checked\"\n            checkable\n            :fade=\"false\"\n            @on-change=\"handleUserClick\"\n          >\n            <span :title=\"` ${item.username} `\">\n              {{ ` ${item.username} ` }}\n            </span>\n          </Tag>\n        </Card>\n      </Col>\n      <Col span=\"7\" offset=\"1\">\n        <Card>\n          <p slot=\"title\">\n            {{ $t(\"role\") }}\n            <Button\n              icon=\"ios-add\"\n              type=\"dashed\"\n              size=\"small\"\n              @click=\"openAddRoleModal\"\n              >{{ $t(\"add_role\") }}</Button\n            >\n          </p>\n          <div class=\"role-item\" v-for=\"item in roles\" :key=\"item.id\">\n            <Tag\n              :name=\"item.id\"\n              :color=\"item.color\"\n              :checked=\"item.checked\"\n              checkable\n              :fade=\"false\"\n              @on-change=\"handleRoleClick\"\n            >\n              <span :title=\"item.displayName\">{{ item.displayName }}</span>\n            </Tag>\n            <Button\n              icon=\"ios-build\"\n              type=\"dashed\"\n              size=\"small\"\n              @click=\"openUserManageModal(item.id)\"\n              >{{ $t(\"user\") }}</Button\n            >\n          </div>\n        </Card>\n      </Col>\n      <Col span=\"7\" offset=\"1\">\n        <Card>\n          <p slot=\"title\">{{ $t(\"menus\") }}</p>\n          <Tree\n            :data=\"menus\"\n            show-checkbox\n            @on-check-change=\"handleMenuTreeCheck\"\n          ></Tree>\n        </Card>\n      </Col>\n    </Row>\n    <Modal\n      v-model=\"addUserModalVisible\"\n      :title=\"$t('add_user')\"\n      @on-ok=\"addUser\"\n      @on-cancel=\"cancel\"\n    >\n      <Form\n        class=\"validation-form\"\n        ref=\"addedUserForm\"\n        :model=\"addedUser\"\n        label-position=\"left\"\n        :label-width=\"100\"\n      >\n        <FormItem :label=\"$t('username')\" prop=\"username\">\n          <Input v-model=\"addedUser.username\" />\n        </FormItem>\n        <FormItem :label=\"$t('password')\" prop=\"fullName\">\n          <Input type=\"password\" v-model=\"addedUser.password\" />\n        </FormItem>\n      </Form>\n    </Modal>\n    <Modal\n      v-model=\"addRoleModalVisible\"\n      :title=\"$t('add_role')\"\n      @on-ok=\"addRole\"\n      @on-cancel=\"cancel\"\n    >\n      <Form\n        class=\"validation-form\"\n        :model=\"addedRole\"\n        label-position=\"left\"\n        :label-width=\"100\"\n      >\n        <FormItem :label=\"$t('role')\">\n          <Input v-model=\"addedRole.name\" :placeholder=\"$t('please_input')\" />\n        </FormItem>\n        <FormItem :label=\"$t('display_name')\">\n          <Input\n            v-model=\"addedRole.displayName\"\n            :placeholder=\"$t('please_input')\"\n          />\n        </FormItem>\n      </Form>\n    </Modal>\n    <Modal\n      v-model=\"userManageModal\"\n      width=\"700\"\n      :title=\"$t('edit_user')\"\n      @on-ok=\"confirmUser\"\n      @on-cancel=\"confirmUser\"\n    >\n      <Transfer\n        :titles=\"transferTitles\"\n        :list-style=\"transferStyle\"\n        :data=\"allUsersForTransfer\"\n        :target-keys=\"usersKeyBySelectedRole\"\n        :render-format=\"renderUserNameForTransfer\"\n        @on-change=\"handleUserTransferChange\"\n        filterable\n      ></Transfer>\n    </Modal>\n  </div>\n</template>\n<script>\nimport {\n  userCreate,\n  getUserList,\n  deleteUser,\n  roleCreate,\n  getRoleList,\n  deleteRole,\n  getRolesByUserName,\n  getUsersByRoleId,\n  grantRolesForUser,\n  revokeRolesForUser,\n  getAllMenusList,\n  getMenusByUserName,\n  getMenusByRoleId,\n  updateRoleToMenusByRoleId\n} from \"@/api/server\";\nimport { MENUS } from \"@/const/menus.js\";\n\nexport default {\n  data() {\n    return {\n      users: [],\n      roles: [],\n      addedUser: {},\n      addedRole: {},\n      addedRoleValue: \"\",\n      transferTitles: [this.$t(\"unselected_user\"), this.$t(\"selected_user\")],\n      transferStyle: { width: \"300px\" },\n      usersKeyBySelectedRole: [],\n      allUsersForTransfer: [],\n      addUserModalVisible: false,\n      addRoleModalVisible: false,\n      userManageModal: false,\n      originMenus: [],\n      menus: []\n    };\n  },\n  methods: {\n    async handleMenuTreeCheck(allChecked, currentChecked) {\n      const menuCodes = allChecked.filter(i => i.category).map(_ => _.code);\n      const { status, message, data } = await updateRoleToMenusByRoleId(\n        this.currentRoleId,\n        menuCodes\n      );\n      if (status === \"OK\") {\n        this.$Notice.success({\n          title: \"success\",\n          desc: message\n        });\n      }\n      this.handleRoleClick(true, this.currentRoleId);\n    },\n    async getAllMenus() {\n      const { status, message, data } = await getAllMenusList();\n      if (status === \"OK\") {\n        this.originMenus = data;\n      }\n      this.menus = this.menusResponseHandeler(this.originMenus);\n    },\n    menusPermissionSelected(allMenus, menusPermissions = []) {\n      allMenus.forEach(_ => {\n        _.children.forEach(m => {\n          const subMenu = menusPermissions.find(n => m.code === n.code);\n          m.checked = subMenu ? true : false;\n        });\n        _.indeterminate = false;\n        _.checked = false;\n      });\n    },\n    menusResponseHandeler(data, disabled = true) {\n      let menus = [];\n      data.forEach(_ => {\n        if (!_.category) {\n          let menuObj = MENUS.find(m => m.code === _.code);\n          menus.push({\n            ..._,\n            title:\n              _.source === \"SYSTEM\"\n                ? this.$lang === \"zh-CN\"\n                  ? menuObj.cnName\n                  : menuObj.enName\n                : _.displayName,\n            id: _.id,\n            expand: true,\n            checked: false,\n            children: [],\n            disabled\n          });\n        }\n      });\n      data.forEach(_ => {\n        if (_.category) {\n          let menuObj = MENUS.find(m => m.code === _.code);\n          menus.forEach(h => {\n            if (_.category === h.id) {\n              h.children.push({\n                ..._,\n                title:\n                  _.source === \"SYSTEM\"\n                    ? this.$lang === \"zh-CN\"\n                      ? menuObj.cnName\n                      : menuObj.enName\n                    : _.displayName,\n                id: _.id,\n                expand: true,\n                checked: false,\n                disabled\n              });\n            }\n          });\n        }\n      });\n      return menus;\n    },\n    renderUserNameForTransfer(item) {\n      return item.label;\n    },\n    async getAllUsers() {\n      let { status, data, message } = await getUserList();\n      if (status === \"OK\") {\n        this.users = data.map(_ => {\n          return {\n            ..._,\n            checked: false,\n            color: \"#5cadff\"\n          };\n        });\n      }\n    },\n    async getAllRoles() {\n      let { status, data, message } = await getRoleList();\n      if (status === \"OK\") {\n        this.roles = data.map(_ => {\n          return {\n            ..._,\n            checked: false,\n            color: \"success\"\n          };\n        });\n      }\n    },\n    async handleUserClick(checked, name) {\n      this.currentRoleId = 0;\n      this.users.forEach(_ => {\n        _.checked = false;\n        if (name === _.username) {\n          _.checked = checked;\n        }\n      });\n      let permissions = await getMenusByUserName(name);\n      if (permissions.status === \"OK\") {\n        const userMenus = [].concat(...permissions.data.map(_ => _.menuList));\n        this.menusPermissionSelected(this.menus, userMenus);\n      }\n      let { status, data, message } = await getRolesByUserName(name);\n      if (status === \"OK\") {\n        this.roles.forEach(_ => {\n          _.checked = false;\n          const found = data.find(item => item.id === _.id);\n          if (found) {\n            _.checked = checked;\n          }\n          // this.menus = this.menusResponseHandeler(this.allMenusOriginResponse);\n        });\n      }\n    },\n    async handleRoleClick(checked, id) {\n      this.currentRoleId = id;\n      // this.menus = this.menusResponseHandeler(\n      //   this.allMenusOriginResponse,\n      //   false\n      // );\n      this.roles.forEach(_ => {\n        _.checked = false;\n        if (id === _.id) {\n          _.checked = checked;\n        }\n      });\n      this.menus = this.menusResponseHandeler(this.originMenus, false);\n      let permissions = await getMenusByRoleId(id);\n      if (permissions.status === \"OK\") {\n        this.menusPermissionSelected(this.menus, permissions.data.menuList);\n      }\n      let { status, data, message } = await getUsersByRoleId(id);\n      if (status === \"OK\") {\n        this.users.forEach(_ => {\n          _.checked = false;\n          const found = data.find(item => item.username === _.username);\n          if (found) {\n            _.checked = checked;\n          }\n        });\n      }\n    },\n    async handleUserTransferChange(newTargetKeys, direction, moveKeys) {\n      if (direction === \"right\") {\n        let { status, data, message } = await grantRolesForUser(\n          moveKeys,\n          this.selectedRole\n        );\n        if (status === \"OK\") {\n          this.$Notice.success({\n            title: \"success\",\n            desc: message\n          });\n          this.usersKeyBySelectedRole = newTargetKeys;\n        }\n      } else {\n        let { status, data, message } = await revokeRolesForUser(\n          moveKeys,\n          this.selectedRole\n        );\n        if (status === \"OK\") {\n          this.$Notice.success({\n            title: \"success\",\n            desc: message\n          });\n          this.usersKeyBySelectedRole = newTargetKeys;\n        }\n      }\n    },\n    confirmUser() {\n      if (this.currentRoleId !== 0) {\n        this.handleRoleClick(true, this.currentRoleId);\n      }\n    },\n    async openUserManageModal(id) {\n      this.usersKeyBySelectedRole = [];\n      this.allUsersForTransfer = [];\n      this.selectedRole = id;\n      let { status, data, message } = await getUsersByRoleId(id);\n      if (status === \"OK\") {\n        this.usersKeyBySelectedRole = data.map(_ => _.id);\n      }\n      this.allUsersForTransfer = this.users.map(_ => {\n        return {\n          key: _.id,\n          username: _.username,\n          label: _.username || \"\"\n        };\n      });\n      this.userManageModal = true;\n    },\n    async addUser() {\n      if (!this.addedUser.username) {\n        this.$Notice.warning({\n          title: \"Warning\",\n          desc: this.$t(\"username_cannot_empty\")\n        });\n        return;\n      }\n      if (!this.addedUser.password) {\n        this.$Notice.warning({\n          title: \"Warning\",\n          desc: this.$t(\"password_cannot_empty\")\n        });\n        return;\n      }\n      let { status, data, message } = await userCreate(this.addedUser);\n      if (status === \"OK\") {\n        this.$Notice.success({\n          title: \"success\",\n          desc: message\n        });\n        this.addedUser = {};\n        this.getAllUsers();\n      }\n    },\n    async addRole() {\n      if (!this.addedRole.name) {\n        this.$Notice.warning({\n          title: \"Warning\",\n          desc: this.$t(\"role_cannot_empty\")\n        });\n        return;\n      }\n      let { status, data, message } = await roleCreate(this.addedRole);\n      if (status === \"OK\") {\n        this.$Notice.success({\n          title: \"success\",\n          desc: message\n        });\n        this.getAllRoles();\n      }\n    },\n    openAddRoleModal() {\n      this.addRoleModalVisible = true;\n    },\n    openAddUserModal() {\n      this.addUserModalVisible = true;\n    },\n    cancel() {}\n  },\n  created() {\n    this.getAllUsers();\n    this.getAllRoles();\n    this.getAllMenus();\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.ivu-tag {\n  display: block;\n  border: #515a61 1px dashed !important;\n  .ivu-tag-text {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: block;\n  }\n}\n\n.role-item {\n  .ivu-tag {\n    display: inline-block;\n    width: 65%;\n  }\n}\n.data-permissions {\n  width: 100%;\n  height: 30px;\n  border: 1px dashed gray;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-radius: 5px;\n  margin-bottom: 5px;\n}\n.ciTypes-options {\n  float: right;\n  line-height: 30px;\n}\n.ciTypes {\n  float: left;\n  line-height: 30px;\n}\n.ciTypes-options {\n  .ivu-checkbox-indeterminate .ivu-checkbox-inner {\n    background-color: #4ee643;\n  }\n  .ivu-checkbox-disabled.ivu-checkbox-checked .ivu-checkbox-inner {\n    background-color: #2d8cf0;\n  }\n}\n</style>\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Row',[_c('Col',{attrs:{\"span\":\"7\"}},[_c('Card',[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"\\n          \"+_vm._s(_vm.$t(\"user\"))+\"\\n          \"),_c('Button',{attrs:{\"icon\":\"ios-add\",\"type\":\"dashed\",\"size\":\"small\"},on:{\"click\":_vm.openAddUserModal}},[_vm._v(_vm._s(_vm.$t(\"add_user\")))])],1),_vm._v(\" \"),_vm._l((_vm.users),function(item){return _c('Tag',{key:item.id,attrs:{\"name\":item.username,\"color\":item.color,\"checked\":item.checked,\"checkable\":\"\",\"fade\":false},on:{\"on-change\":_vm.handleUserClick}},[_c('span',{attrs:{\"title\":(\" \" + (item.username) + \" \")}},[_vm._v(\"\\n            \"+_vm._s((\" \" + (item.username) + \" \"))+\"\\n          \")])])})],2)],1),_vm._v(\" \"),_c('Col',{attrs:{\"span\":\"7\",\"offset\":\"1\"}},[_c('Card',[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"\\n          \"+_vm._s(_vm.$t(\"role\"))+\"\\n          \"),_c('Button',{attrs:{\"icon\":\"ios-add\",\"type\":\"dashed\",\"size\":\"small\"},on:{\"click\":_vm.openAddRoleModal}},[_vm._v(_vm._s(_vm.$t(\"add_role\")))])],1),_vm._v(\" \"),_vm._l((_vm.roles),function(item){return _c('div',{key:item.id,staticClass:\"role-item\"},[_c('Tag',{attrs:{\"name\":item.id,\"color\":item.color,\"checked\":item.checked,\"checkable\":\"\",\"fade\":false},on:{\"on-change\":_vm.handleRoleClick}},[_c('span',{attrs:{\"title\":item.displayName}},[_vm._v(_vm._s(item.displayName))])]),_vm._v(\" \"),_c('Button',{attrs:{\"icon\":\"ios-build\",\"type\":\"dashed\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.openUserManageModal(item.id)}}},[_vm._v(_vm._s(_vm.$t(\"user\")))])],1)})],2)],1),_vm._v(\" \"),_c('Col',{attrs:{\"span\":\"7\",\"offset\":\"1\"}},[_c('Card',[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(_vm.$t(\"menus\")))]),_vm._v(\" \"),_c('Tree',{attrs:{\"data\":_vm.menus,\"show-checkbox\":\"\"},on:{\"on-check-change\":_vm.handleMenuTreeCheck}})],1)],1)],1),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":_vm.$t('add_user')},on:{\"on-ok\":_vm.addUser,\"on-cancel\":_vm.cancel},model:{value:(_vm.addUserModalVisible),callback:function ($$v) {_vm.addUserModalVisible=$$v},expression:\"addUserModalVisible\"}},[_c('Form',{ref:\"addedUserForm\",staticClass:\"validation-form\",attrs:{\"model\":_vm.addedUser,\"label-position\":\"left\",\"label-width\":100}},[_c('FormItem',{attrs:{\"label\":_vm.$t('username'),\"prop\":\"username\"}},[_c('Input',{model:{value:(_vm.addedUser.username),callback:function ($$v) {_vm.$set(_vm.addedUser, \"username\", $$v)},expression:\"addedUser.username\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":_vm.$t('password'),\"prop\":\"fullName\"}},[_c('Input',{attrs:{\"type\":\"password\"},model:{value:(_vm.addedUser.password),callback:function ($$v) {_vm.$set(_vm.addedUser, \"password\", $$v)},expression:\"addedUser.password\"}})],1)],1)],1),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":_vm.$t('add_role')},on:{\"on-ok\":_vm.addRole,\"on-cancel\":_vm.cancel},model:{value:(_vm.addRoleModalVisible),callback:function ($$v) {_vm.addRoleModalVisible=$$v},expression:\"addRoleModalVisible\"}},[_c('Form',{staticClass:\"validation-form\",attrs:{\"model\":_vm.addedRole,\"label-position\":\"left\",\"label-width\":100}},[_c('FormItem',{attrs:{\"label\":_vm.$t('role')}},[_c('Input',{attrs:{\"placeholder\":_vm.$t('please_input')},model:{value:(_vm.addedRole.name),callback:function ($$v) {_vm.$set(_vm.addedRole, \"name\", $$v)},expression:\"addedRole.name\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":_vm.$t('display_name')}},[_c('Input',{attrs:{\"placeholder\":_vm.$t('please_input')},model:{value:(_vm.addedRole.displayName),callback:function ($$v) {_vm.$set(_vm.addedRole, \"displayName\", $$v)},expression:\"addedRole.displayName\"}})],1)],1)],1),_vm._v(\" \"),_c('Modal',{attrs:{\"width\":\"700\",\"title\":_vm.$t('edit_user')},on:{\"on-ok\":_vm.confirmUser,\"on-cancel\":_vm.confirmUser},model:{value:(_vm.userManageModal),callback:function ($$v) {_vm.userManageModal=$$v},expression:\"userManageModal\"}},[_c('Transfer',{attrs:{\"titles\":_vm.transferTitles,\"list-style\":_vm.transferStyle,\"data\":_vm.allUsersForTransfer,\"target-keys\":_vm.usersKeyBySelectedRole,\"render-format\":_vm.renderUserNameForTransfer,\"filterable\":\"\"},on:{\"on-change\":_vm.handleUserTransferChange}})],1)],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }","function injectStyle (context) {\n  require(\"!!vue-loader/node_modules/vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-62d6cfa0\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!sass-loader!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./user-role-management.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./user-role-management.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./user-role-management.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-62d6cfa0\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./user-role-management.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-62d6cfa0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n"],"sourceRoot":""}