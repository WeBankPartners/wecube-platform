{"version":3,"sources":["webpack:///./node_modules/core-js/library/fn/get-iterator.js","webpack:///./src/pages/implementation/artifact-management.vue?7357","webpack:///./node_modules/@babel/runtime-corejs2/core-js/get-iterator.js","webpack:///./node_modules/core-js/modules/es6.string.iterator.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/nonIterableRest.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray.js","webpack:///./node_modules/core-js/library/modules/core.get-iterator.js","webpack:///src/pages/implementation/artifact-management.vue","webpack:///./src/pages/implementation/artifact-management.vue?8836","webpack:///./src/pages/implementation/artifact-management.vue","webpack:///./src/pages/implementation/artifact-management.vue?aab0"],"names":["module","exports","content","i","locals","add","default","$at","String","iterated","this","_t","_i","point","O","index","length","value","undefined","done","_arrayWithHoles","arr","_iterableToArrayLimit","_arr","_n","_d","_e","_s","next","push","err","_nonIterableRest","TypeError","_slicedToArray","anObject","get","getIterator","it","iterFn","call","data","packageCiType","statusOperations","systemDesignVersions","systemDesignVersion","ciTypesObj","ciTypeAttributeObj","ciTypes","treeData","treeLoading","loadingForSave","selectFile","filesTreeData","guid","currentPackage","packageId","isShowFilesModal","isShowTreeModal","treeModalOpt","currentTreeModal","tableLoading","tableData","tableColumns","pageInfo","pageSize","currentPage","total","activeTab","diffTabData","tabData","selectNode","attrsTableColomnOptions","computed","setUploadActionHeader","document","cookie","split","nowTab","find","_","title","result","methods","renderActionButton","selectSystemDesignVersion","getSystemDesignVersion","formatTreeData","array","map","name","level","children","expand","selectTreeNode","node","r_guid","queryPackages","pageChange","pageSizeChange","genFilesTreedata","currentDir","filesArray","forEach","targetNode","dir","formatChildrenData","files","Array","path","isDir","obj","render","expandNode","getFiles","rowClick","row","getTabDatas","diff_conf_file","changeStatus","status","showFilesModal","handleDelete","handleStatusChange","JSON","parse","stringify","diffFile","f","getKeys","showTreeModal","type","closeModal","onOk","key","join","closeTreeModal","checkboxChange","splice","tabChange","tabName","updateRoutine","routine","val","saveAttr","saveDiffConfigEnumCodes","code","created","fetchData","getAllCITypesByLayerWithAttr","getAllCiTypesByCatalog","getAllSystemEnumCodes","_vm","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","on","model","callback","$$v","expression","_l","version","fixed_date","saveConfigFiles","start_file","stop_file","deploy_file","item","staticRenderFns","injectStyle","context","__vue_template_functional__","__vue_styles__","__vue_scopeId__","__vue_module_identifier__","Component"],"mappings":"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","file":"js/chunk-ae615ace.c6b017af.js","sourcesContent":["require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-48bf41c5\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../../node_modules/sass-loader/lib/loader.js!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./artifact-management.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-loader/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7fb5a532\", content, true, {});","module.exports = require(\"core-js/library/fn/get-iterator\");","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n","import _Array$isArray from \"../../core-js/array/is-array\";\nexport default function _arrayWithHoles(arr) {\n  if (_Array$isArray(arr)) return arr;\n}","import _getIterator from \"../../core-js/get-iterator\";\nexport default function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = _getIterator(arr), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n","<template>\n  <Row class=\"artifact-management\">\n    <Col span=\"6\">\n      <Card>\n        <p slot=\"title\">系统设计版本</p>\n        <Select\n          @on-change=\"selectSystemDesignVersion\"\n          label-in-name\n          v-model=\"systemDesignVersion\"\n        >\n          <Option\n            v-for=\"version in systemDesignVersions\"\n            :value=\"version.guid || ''\"\n            :key=\"version.guid\"\n            >{{\n              version.fixed_date\n                ? `${version.name}[${version.fixed_date}]`\n                : version.name\n            }}</Option\n          >\n        </Select>\n      </Card>\n      <Card class=\"artifact-management-bottom-card\">\n        <p slot=\"title\">系统设计列表</p>\n        <div class=\"artifact-management-tree-body\">\n          <Tree :data=\"treeData\" @on-select-change=\"selectTreeNode\"></Tree>\n          <Spin size=\"large\" fix v-if=\"treeLoading\">\n            <Icon type=\"ios-loading\" size=\"24\" class=\"spin-icon-load\"></Icon>\n            <div>loading...</div>\n          </Spin>\n        </div>\n      </Card>\n    </Col>\n    <Col span=\"17\" offset=\"1\">\n      <Card v-if=\"guid\" class=\"artifact-management-top-card\">\n        <Upload\n          :action=\"`/artifact/unit-designs/${guid}/packages/upload`\"\n          :headers=\"setUploadActionHeader\"\n          :on-success=\"queryPackages\"\n          slot=\"title\"\n        >\n          <Button icon=\"ios-cloud-upload-outline\">上传新包</Button>\n        </Upload>\n        <SimpleTable\n          :loading=\"tableLoading\"\n          :columns=\"tableColumns\"\n          :data=\"tableData\"\n          :page=\"pageInfo\"\n          @pageChange=\"pageChange\"\n          @pageSizeChange=\"pageSizeChange\"\n          @rowClick=\"rowClick\"\n        ></SimpleTable>\n        <Modal\n          v-model=\"isShowFilesModal\"\n          title=\"脚本配置\"\n          okText=\"保存\"\n          :loading=\"loadingForSave\"\n          @on-ok=\"saveConfigFiles\"\n          @on-cancel=\"closeModal\"\n        >\n          <Card class=\"artifact-management-files-card\">\n            <div slot=\"title\">\n              <span>差异化文件</span>\n              <Button @click=\"() => showTreeModal(0)\" size=\"small\"\n                >选择文件</Button\n              >\n            </div>\n            <span>{{ currentPackage.diff_conf_file || \"未选择\" }}</span>\n          </Card>\n          <Card class=\"artifact-management-files-card\">\n            <div slot=\"title\">\n              <span>启动脚本</span>\n              <Button @click=\"() => showTreeModal(1)\" size=\"small\"\n                >选择文件</Button\n              >\n            </div>\n            <span>{{ currentPackage.start_file || \"未选择\" }}</span>\n          </Card>\n          <Card class=\"artifact-management-files-card\">\n            <div slot=\"title\">\n              <span>停止脚本</span>\n              <Button @click=\"() => showTreeModal(2)\" size=\"small\"\n                >选择文件</Button\n              >\n            </div>\n            <span>{{ currentPackage.stop_file || \"未选择\" }}</span>\n          </Card>\n          <Card class=\"artifact-management-files-card\">\n            <div slot=\"title\">\n              <span>部署脚本</span>\n              <Button @click=\"() => showTreeModal(3)\" size=\"small\"\n                >选择文件</Button\n              >\n            </div>\n            <span>{{ currentPackage.deploy_file || \"未选择\" }}</span>\n          </Card>\n        </Modal>\n        <Modal\n          v-model=\"isShowTreeModal\"\n          :title=\"currentTreeModal.title\"\n          @on-ok=\"onOk\"\n          @on-cancel=\"closeTreeModal\"\n        >\n          <RadioGroup v-model=\"selectFile\">\n            <Tree :data=\"filesTreeData\" @on-toggle-expand=\"expandNode\"></Tree>\n          </RadioGroup>\n        </Modal>\n      </Card>\n      <Card\n        v-if=\"tabData.length ? true : false\"\n        class=\"artifact-management-bottom-card artifact-management-top-card\"\n      >\n        <Tabs v-model=\"activeTab\" @on-click=\"tabChange\">\n          <TabPane\n            v-for=\"(item, index) in tabData\"\n            :label=\"item.title\"\n            :name=\"item.title\"\n            :key=\"index\"\n          >\n            <Table\n              :data=\"item.tableData || []\"\n              :columns=\"attrsTableColomnOptions\"\n            ></Table>\n          </TabPane>\n        </Tabs>\n      </Card>\n    </Col>\n  </Row>\n</template>\n\n<script>\nimport {\n  getPackageCiTypeId,\n  getAllCITypesByLayerWithAttr,\n  getSystemDesignVersions,\n  getAllCiTypesByCatalog,\n  getSystemDesignVersion,\n  queryPackages,\n  deleteCiDatas,\n  operateCiState,\n  getFiles,\n  getKeys,\n  saveConfigFiles,\n  saveDiffConfigEnumCodes,\n  getDiffConfigEnumCodes,\n  getAllSystemEnumCodes\n} from \"@/api/server.js\";\n\nexport default {\n  data() {\n    return {\n      packageCiType: 0,\n      statusOperations: [],\n      systemDesignVersions: [],\n      systemDesignVersion: \"\",\n      ciTypesObj: {},\n      ciTypeAttributeObj: {},\n      ciTypes: [],\n      treeData: [],\n      treeLoading: false,\n      loadingForSave: false,\n      selectFile: \"\",\n      filesTreeData: [],\n      guid: \"\",\n      currentPackage: {},\n      packageId: \"\",\n      isShowFilesModal: false,\n      isShowTreeModal: false,\n      treeModalOpt: [\n        {\n          title: \"选择差异化文件\",\n          key: \"diff_conf_file\",\n          inputType: \"checkbox\"\n        },\n        {\n          title: \"选择启动脚本\",\n          key: \"start_file\",\n          inputType: \"radio\"\n        },\n        {\n          title: \"选择停止脚本\",\n          key: \"stop_file\",\n          inputType: \"radio\"\n        },\n        {\n          title: \"选择部署脚本\",\n          key: \"deploy_file\",\n          inputType: \"radio\"\n        }\n      ],\n      currentTreeModal: {},\n      tableLoading: false,\n      tableData: [],\n      tableColumns: [\n        {\n          title: \"包名\",\n          key: \"name\"\n        },\n        {\n          title: \"上传时间\",\n          width: 150,\n          key: \"upload_time\"\n        },\n        {\n          title: \"MD5值\",\n          key: \"md5_value\"\n        },\n        {\n          title: \"上传人\",\n          key: \"updated_by\"\n        },\n        {\n          title: \"差异化文件\",\n          key: \"diff_conf_file\"\n        },\n        {\n          title: \"启动脚本\",\n          key: \"start_file\"\n        },\n        {\n          title: \"停止脚本\",\n          key: \"stop_file\"\n        },\n        {\n          title: \"部署脚本\",\n          key: \"deploy_file\"\n        },\n        {\n          title: \"操作\",\n          key: \"state\",\n          width: 150,\n          render: (h, params) => {\n            return (\n              <div style=\"padding-top:5px\">\n                {this.renderActionButton(params)}\n              </div>\n            );\n          }\n        }\n      ],\n      pageInfo: {\n        pageSize: 5,\n        currentPage: 1,\n        total: 0\n      },\n      activeTab: \"\",\n      diffTabData: \"\",\n      tabData: [],\n      selectNode: [],\n      attrsTableColomnOptions: [\n        {\n          title: \"序号\",\n          key: \"index\",\n          width: 60\n        },\n        {\n          title: \"文件行号\",\n          key: \"line\"\n        },\n        {\n          title: \"properties-key\",\n          key: \"key\"\n        },\n        {\n          title: \"CMDB-ATTR\",\n          render: (h, params) => {\n            return params.row.attrInputValue ? (\n              <AttrInput\n                style=\"margin-top:5px;\"\n                allCiTypes={this.ciTypes}\n                rootCiType={15}\n                isReadOnly={true}\n                ciTypesObj={this.ciTypesObj}\n                ciTypeAttributeObj={this.ciTypeAttributeObj}\n                sourceData={params.row.attrInputValue}\n                onUpdateRoutine={val => this.updateRoutine(val, params.index)}\n              />\n            ) : (\n              <div style=\"align-items:center;display:flex;\">\n                <AttrInput\n                  style=\"margin-top:5px;width:calc(100% - 55px);\"\n                  allCiTypes={this.ciTypes}\n                  rootCiType={15}\n                  ciTypesObj={this.ciTypesObj}\n                  ciTypeAttributeObj={this.ciTypeAttributeObj}\n                  onUpdateRoutine={val => this.updateRoutine(val, params.index)}\n                />\n                <Button\n                  size=\"small\"\n                  type=\"primary\"\n                  style=\"margin-left:10px\"\n                  onClick={() => this.saveAttr(params.index)}\n                >\n                  保存\n                </Button>\n              </div>\n            );\n          }\n        }\n      ]\n    };\n  },\n  computed: {\n    setUploadActionHeader() {\n      return {\n        \"X-XSRF-TOKEN\": document.cookie.split(\"=\")[1]\n      };\n    },\n    nowTab() {\n      let result = 0;\n      this.tabData.find((_, i) => {\n        if (_.title === this.activeTab) {\n          result = i;\n          return true;\n        }\n      });\n      return result;\n    }\n  },\n  methods: {\n    renderActionButton(params) {\n      const row = params.row;\n      return this.statusOperations\n        .filter(_ => row.nextOperations.indexOf(_.type) >= 0)\n        .map(_ => {\n          return (\n            <Button\n              {...{ props: { ..._.props } }}\n              style=\"margin-right:5px;margin-bottom:5px;\"\n              onClick={() => this.changeStatus(row, _.type)}\n            >\n              {_.label}\n            </Button>\n          );\n        });\n    },\n    async fetchData() {\n      const [sysData, packageCiType] = await Promise.all([\n        getSystemDesignVersions(),\n        getPackageCiTypeId()\n      ]);\n      if (sysData.status === \"OK\" && sysData.data.contents instanceof Array) {\n        this.systemDesignVersions = sysData.data.contents.map(_ => _.data);\n      }\n      if (packageCiType.status === \"OK\") {\n        this.packageCiType = packageCiType.data;\n      }\n    },\n    async getAllCITypesByLayerWithAttr() {\n      let { status, data, message } = await getAllCITypesByLayerWithAttr([\n        \"notCreated\",\n        \"created\",\n        \"dirty\",\n        \"decommissioned\"\n      ]);\n      if (status === \"OK\") {\n        let ciTypes = {};\n        let ciTypeAttrs = {};\n        data.forEach(layer => {\n          if (layer.ciTypes instanceof Array) {\n            layer.ciTypes.forEach(citype => {\n              ciTypes[citype.ciTypeId] = citype;\n              if (citype.attributes instanceof Array) {\n                citype.attributes.forEach(citypeAttr => {\n                  ciTypeAttrs[citypeAttr.ciTypeAttrId] = citypeAttr;\n                });\n              }\n            });\n          }\n        });\n        this.ciTypesObj = ciTypes;\n        this.ciTypeAttributeObj = ciTypeAttrs;\n      }\n    },\n    async getAllCiTypesByCatalog() {\n      let { status, data, message } = await getAllCiTypesByCatalog();\n      if (status === \"OK\") {\n        this.ciTypes = data;\n      }\n    },\n    async getSystemDesignVersion(guid) {\n      this.treeLoading = true;\n      let { status, data, message } = await getSystemDesignVersion(guid);\n      if (status === \"OK\") {\n        this.treeData = this.formatTreeData(data, 1);\n        this.treeLoading = false;\n      }\n    },\n    async queryPackages() {\n      this.tableLoading = true;\n      let { status, data, message } = await queryPackages(this.guid, {\n        sorting: {\n          asc: false,\n          field: \"upload_time\"\n        },\n        paging: true,\n        pageable: {\n          pageSize: this.pageInfo.pageSize,\n          startIndex: (this.pageInfo.currentPage - 1) * this.pageInfo.pageSize\n        }\n      });\n      if (status === \"OK\") {\n        this.tableLoading = false;\n        this.tableData = data.contents.map(_ => {\n          return {\n            ..._.data,\n            nextOperations: _.meta.nextOperations || []\n          };\n        });\n        const { pageSize, totalRows: total } = data.pageInfo;\n        const currentPage = this.pageInfo.currentPage;\n        this.pageInfo = { currentPage, pageSize, total };\n      }\n    },\n    async getFiles(packageId, currentDir) {\n      this.packageId = packageId;\n      let { status, data, message } = await getFiles(this.guid, packageId, {\n        currentDir\n      });\n      if (status === \"OK\") {\n        this.isShowFilesModal = true;\n        this.genFilesTreedata({ files: data.outputs[0].files, currentDir });\n      }\n    },\n    async getKeys(options) {\n      if (!options) return;\n      let { status, data, message } = await getKeys(this.guid, this.packageId, {\n        filePath: options.path\n      });\n      if (status === \"OK\") {\n        const diffConfigEnums = await getDiffConfigEnumCodes();\n        if (diffConfigEnums.status === \"OK\") {\n          const result = data.outputs[0].config_key_infos.map((_, i) => {\n            _.index = i + 1;\n            const found = diffConfigEnums.data.find(\n              item => item.code === _.key\n            );\n            if (found) {\n              _.attrInputValue = found.value;\n            }\n            return _;\n          });\n          this.$set(options, \"tableData\", result);\n        }\n      }\n    },\n    async saveConfigFiles() {\n      this.loadingForSave = true;\n      const obj = {\n        configFilesWithPath: this.diffTabData.split(\"|\"),\n        startFile: this.currentPackage.start_file || \"\",\n        stopFile: this.currentPackage.stop_file || \"\",\n        deployFile: this.currentPackage.deploy_file || \"\"\n      };\n      let { status, data, message } = await saveConfigFiles(\n        this.guid,\n        this.packageId,\n        obj\n      );\n      if (status === \"OK\") {\n        this.loadingForSave = false;\n        this.$Notice.success({\n          title: \"保存成功\"\n        });\n      }\n      this.queryPackages();\n      this.getTabDatas(this.diffTabData);\n    },\n    async saveDiffConfigEnumCodes(obj) {\n      let { status, data, message } = await saveDiffConfigEnumCodes(obj);\n      if (status === \"OK\") {\n        this.$Notice.success({\n          title: \"保存成功\"\n        });\n        this.getKeys(this.tabData[this.nowTab]);\n      }\n    },\n    selectSystemDesignVersion(guid) {\n      this.getSystemDesignVersion(guid);\n    },\n    formatTreeData(array, level) {\n      return array.map(_ => {\n        _.title = _.data.name;\n        _.level = level;\n        if (_.children && _.children.length) {\n          _.expand = true;\n          _.children = this.formatTreeData(_.children, level + 1);\n        }\n        return _;\n      });\n    },\n    selectTreeNode(node) {\n      if (node.length && node[0].level === 3) {\n        this.guid = node[0].data.r_guid;\n        this.queryPackages();\n        this.tabData = [];\n      }\n    },\n    pageChange(currentPage) {\n      this.pageInfo.currentPage = currentPage;\n      this.queryPackages();\n    },\n    pageSizeChange(pageSize) {\n      this.pageInfo.pageSize = pageSize;\n      this.queryPackages();\n    },\n    genFilesTreedata(data) {\n      const { files, currentDir } = data;\n      if (currentDir) {\n        const filesArray = currentDir.split(\"/\");\n        let targetNode = this.filesTreeData;\n        filesArray.forEach((dir, index) => {\n          if (index) {\n            targetNode = targetNode.children;\n          }\n          targetNode.find(_ => {\n            if (dir === _.title) {\n              targetNode = _;\n              return true;\n            }\n          });\n        });\n        targetNode.children = this.formatChildrenData({\n          files,\n          currentDir,\n          level: targetNode.level + 1\n        });\n      } else {\n        this.filesTreeData = this.formatChildrenData({\n          files,\n          currentDir,\n          level: 1\n        });\n      }\n    },\n    formatChildrenData(val) {\n      const { files, currentDir, level } = val;\n      if (!(files instanceof Array)) {\n        return;\n      }\n      const tagName = this.currentTreeModal.inputType;\n      return files.map(_ => {\n        let obj = {\n          title: _.name,\n          path: currentDir ? `${currentDir}/${_.name}` : _.name,\n          level: level\n        };\n        if (_.isDir) {\n          obj.children = [{}];\n        } else {\n          obj.render = (h, params) => {\n            return this.currentTreeModal.inputType === \"checkbox\" ? (\n              <Checkbox\n                on-on-change={value => this.checkboxChange(value, params.data)}\n              >\n                <span>{params.data.title}</span>\n              </Checkbox>\n            ) : (\n              <Radio label={params.data.path}>\n                <span>{params.data.title}</span>\n              </Radio>\n            );\n          };\n        }\n        return obj;\n      });\n    },\n    expandNode(node) {\n      if (node.expand && !node.children[0].title) {\n        this.getFiles(this.packageId, node.path);\n      }\n    },\n    rowClick(row) {\n      this.packageId = row.guid;\n      this.getTabDatas(row.diff_conf_file);\n    },\n    changeStatus(row, status) {\n      switch (status) {\n        case \"update\":\n          this.showFilesModal(row);\n          break;\n        case \"delete\":\n          this.handleDelete(row, status);\n          break;\n        default:\n          this.handleStatusChange(row, status);\n          break;\n      }\n    },\n    async handleDelete(row) {\n      this.$Modal.confirm({\n        title: \"确认删除？\",\n        \"z-index\": 1000000,\n        onOk: async () => {\n          const { status, data, message } = await deleteCiDatas({\n            id: this.packageCiType,\n            deleteData: [row.guid]\n          });\n          if (status === \"OK\") {\n            this.$Notice.success({\n              title: \"Delete data Success\",\n              desc: message\n            });\n            this.queryPackages();\n          }\n        }\n      });\n    },\n    async handleStatusChange(row, state) {\n      const { data, status, message } = await operateCiState(\n        this.packageCiType,\n        row.guid,\n        state\n      );\n      if (status === \"OK\") {\n        this.$Notice.success({\n          title: state,\n          desc: message\n        });\n        this.queryPackages();\n      }\n    },\n    showFilesModal(row) {\n      this.tabData = [];\n      this.currentPackage = JSON.parse(JSON.stringify(row));\n      this.packageId = this.currentPackage.guid;\n      this.diffTabData = row.diff_conf_file || \"\";\n      this.isShowFilesModal = true;\n    },\n\n    getTabDatas(diffFile) {\n      if (diffFile) {\n        const files = diffFile.split(\"|\");\n        this.tabData = files.map(_ => {\n          const f = _.split(\"/\");\n          return {\n            path: _,\n            title: f[f.length - 1]\n          };\n        });\n        this.activeTab = this.tabData.length ? this.tabData[0].title : \"\";\n        this.getKeys(this.tabData[0]);\n      } else {\n        this.tabData = [];\n      }\n    },\n    showTreeModal(type) {\n      this.currentTreeModal = this.treeModalOpt[type];\n      if (!this.filesTreeData.length)\n        this.getFiles(this.currentPackage.guid, \"\");\n      this.isShowTreeModal = true;\n    },\n    closeModal() {\n      this.currentPackage = {};\n    },\n    onOk() {\n      if (this.currentTreeModal.key === \"diff_conf_file\") {\n        this.diffTabData = \"\";\n        let files = [];\n        this.selectNode.forEach(_ => {\n          files.push(\"/\" + _.path);\n        });\n        this.diffTabData = files.join(\"|\");\n        this.currentPackage.diff_conf_file = files.join(\"|\");\n        this.selectNode = [];\n        this.filesTreeData = [];\n      } else {\n        this.currentPackage[this.currentTreeModal.key] = \"/\" + this.selectFile;\n      }\n    },\n    closeTreeModal() {\n      this.selectNode = [];\n      this.filesTreeData = [];\n    },\n    checkboxChange(value, data) {\n      if (value) {\n        this.selectNode.push(data);\n      } else {\n        let i = 0;\n        this.selectNode.find((_, index) => {\n          if (_.path === data.path) {\n            i = index;\n            return true;\n          }\n        });\n        this.selectNode.splice(i, 1);\n      }\n    },\n    tabChange(tabName) {\n      this.tabData.find(_ => {\n        if (_.title === tabName && !(_.tableData instanceof Array)) {\n          this.getKeys(_);\n          return true;\n        }\n      });\n    },\n    updateRoutine(val, row) {\n      this.tabData[this.nowTab].tableData[row].routine = JSON.stringify(val);\n    },\n    saveAttr(row) {\n      this.saveDiffConfigEnumCodes({\n        code: this.tabData[this.nowTab].tableData[row].key,\n        value: this.tabData[this.nowTab].tableData[row].routine\n      });\n    },\n    async getAllSystemEnumCodes() {\n      const { status, data, message } = await getAllSystemEnumCodes({\n        filters: [\n          {\n            name: \"cat.catName\",\n            operator: \"eq\",\n            value: \"state_transition_operation\"\n          }\n        ],\n        paging: false\n      });\n      if (status === \"OK\" && data.contents instanceof Array) {\n        const buttonTypes = {\n          confirm: \"info\",\n          delete: \"error\",\n          discard: \"warning\",\n          update: \"primary\"\n        };\n        this.statusOperations = data.contents\n          .filter(\n            _ =>\n              _.code === \"confirm\" ||\n              _.code === \"delete\" ||\n              _.code === \"discard\" ||\n              _.code === \"update\"\n          )\n          .map(_ => {\n            return {\n              type: _.code,\n              label: _.code !== \"update\" ? _.value : \"配置\",\n              props: {\n                type: buttonTypes[_.code] || \"info\",\n                size: \"small\"\n              },\n              actionType: _.code\n            };\n          });\n      }\n    }\n  },\n  created() {\n    this.fetchData();\n    this.getAllCITypesByLayerWithAttr();\n    this.getAllCiTypesByCatalog();\n    this.getAllSystemEnumCodes();\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.artifact-management {\n  padding: 20px;\n\n  &-top-card {\n    padding-bottom: 40px;\n  }\n\n  &-bottom-card {\n    margin-top: 30px;\n  }\n\n  &-tree-body {\n    position: relative;\n  }\n\n  &-save-button {\n    float: right;\n    margin-top: 10px;\n  }\n\n  &-files-card {\n    margin-top: 10px;\n\n    &:first-of-type {\n      margin-top: 0;\n    }\n  }\n}\n</style>\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Row',{staticClass:\"artifact-management\"},[_c('Col',{attrs:{\"span\":\"6\"}},[_c('Card',[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"系统设计版本\")]),_vm._v(\" \"),_c('Select',{attrs:{\"label-in-name\":\"\"},on:{\"on-change\":_vm.selectSystemDesignVersion},model:{value:(_vm.systemDesignVersion),callback:function ($$v) {_vm.systemDesignVersion=$$v},expression:\"systemDesignVersion\"}},_vm._l((_vm.systemDesignVersions),function(version){return _c('Option',{key:version.guid,attrs:{\"value\":version.guid || ''}},[_vm._v(_vm._s(version.fixed_date\n              ? ((version.name) + \"[\" + (version.fixed_date) + \"]\")\n              : version.name))])}),1)],1),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-bottom-card\"},[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"系统设计列表\")]),_vm._v(\" \"),_c('div',{staticClass:\"artifact-management-tree-body\"},[_c('Tree',{attrs:{\"data\":_vm.treeData},on:{\"on-select-change\":_vm.selectTreeNode}}),_vm._v(\" \"),(_vm.treeLoading)?_c('Spin',{attrs:{\"size\":\"large\",\"fix\":\"\"}},[_c('Icon',{staticClass:\"spin-icon-load\",attrs:{\"type\":\"ios-loading\",\"size\":\"24\"}}),_vm._v(\" \"),_c('div',[_vm._v(\"loading...\")])],1):_vm._e()],1)])],1),_vm._v(\" \"),_c('Col',{attrs:{\"span\":\"17\",\"offset\":\"1\"}},[(_vm.guid)?_c('Card',{staticClass:\"artifact-management-top-card\"},[_c('Upload',{attrs:{\"slot\":\"title\",\"action\":(\"/artifact/unit-designs/\" + _vm.guid + \"/packages/upload\"),\"headers\":_vm.setUploadActionHeader,\"on-success\":_vm.queryPackages},slot:\"title\"},[_c('Button',{attrs:{\"icon\":\"ios-cloud-upload-outline\"}},[_vm._v(\"上传新包\")])],1),_vm._v(\" \"),_c('SimpleTable',{attrs:{\"loading\":_vm.tableLoading,\"columns\":_vm.tableColumns,\"data\":_vm.tableData,\"page\":_vm.pageInfo},on:{\"pageChange\":_vm.pageChange,\"pageSizeChange\":_vm.pageSizeChange,\"rowClick\":_vm.rowClick}}),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"脚本配置\",\"okText\":\"保存\",\"loading\":_vm.loadingForSave},on:{\"on-ok\":_vm.saveConfigFiles,\"on-cancel\":_vm.closeModal},model:{value:(_vm.isShowFilesModal),callback:function ($$v) {_vm.isShowFilesModal=$$v},expression:\"isShowFilesModal\"}},[_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"差异化文件\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(0); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.diff_conf_file || \"未选择\"))])]),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"启动脚本\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(1); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.start_file || \"未选择\"))])]),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"停止脚本\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(2); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.stop_file || \"未选择\"))])]),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"部署脚本\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(3); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.deploy_file || \"未选择\"))])])],1),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":_vm.currentTreeModal.title},on:{\"on-ok\":_vm.onOk,\"on-cancel\":_vm.closeTreeModal},model:{value:(_vm.isShowTreeModal),callback:function ($$v) {_vm.isShowTreeModal=$$v},expression:\"isShowTreeModal\"}},[_c('RadioGroup',{model:{value:(_vm.selectFile),callback:function ($$v) {_vm.selectFile=$$v},expression:\"selectFile\"}},[_c('Tree',{attrs:{\"data\":_vm.filesTreeData},on:{\"on-toggle-expand\":_vm.expandNode}})],1)],1)],1):_vm._e(),_vm._v(\" \"),(_vm.tabData.length ? true : false)?_c('Card',{staticClass:\"artifact-management-bottom-card artifact-management-top-card\"},[_c('Tabs',{on:{\"on-click\":_vm.tabChange},model:{value:(_vm.activeTab),callback:function ($$v) {_vm.activeTab=$$v},expression:\"activeTab\"}},_vm._l((_vm.tabData),function(item,index){return _c('TabPane',{key:index,attrs:{\"label\":item.title,\"name\":item.title}},[_c('Table',{attrs:{\"data\":item.tableData || [],\"columns\":_vm.attrsTableColomnOptions}})],1)}),1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }","function injectStyle (context) {\n  require(\"!!vue-loader/node_modules/vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-48bf41c5\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!sass-loader!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./artifact-management.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./artifact-management.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./artifact-management.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-48bf41c5\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./artifact-management.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-48bf41c5\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".artifact-management[data-v-48bf41c5]{padding:20px}.artifact-management-top-card[data-v-48bf41c5]{padding-bottom:40px}.artifact-management-bottom-card[data-v-48bf41c5]{margin-top:30px}.artifact-management-tree-body[data-v-48bf41c5]{position:relative}.artifact-management-save-button[data-v-48bf41c5]{float:right;margin-top:10px}.artifact-management-files-card[data-v-48bf41c5]{margin-top:10px}.artifact-management-files-card[data-v-48bf41c5]:first-of-type{margin-top:0}\", \"\"]);\n\n// exports\n"],"sourceRoot":""}