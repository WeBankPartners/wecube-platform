{"version":3,"sources":["webpack:///./src/pages/implementation/artifact-management.vue?cabe","webpack:///./node_modules/core-js/library/fn/get-iterator.js","webpack:///./node_modules/@babel/runtime-corejs2/core-js/get-iterator.js","webpack:///./node_modules/core-js/modules/es6.string.iterator.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/nonIterableRest.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray.js","webpack:///./node_modules/core-js/library/modules/core.get-iterator.js","webpack:///./src/pages/implementation/artifact-management.vue?98c8","webpack:///src/pages/implementation/artifact-management.vue","webpack:///./src/pages/implementation/artifact-management.vue?ec96","webpack:///./src/pages/implementation/artifact-management.vue"],"names":["content","module","i","locals","exports","add","default","$at","String","iterated","this","_t","_i","point","O","index","length","value","undefined","done","_arrayWithHoles","arr","_iterableToArrayLimit","_arr","_n","_d","_e","_s","next","push","err","_nonIterableRest","TypeError","_slicedToArray","anObject","get","getIterator","it","iterFn","call","data","packageCiType","statusOperations","systemDesignVersions","systemDesignVersion","ciTypesObj","ciTypeAttributeObj","ciTypes","treeData","treeLoading","loadingForSave","selectFile","filesTreeData","guid","currentPackage","packageId","isShowFilesModal","isShowTreeModal","treeModalOpt","currentTreeModal","tableLoading","tableData","tableColumns","pageInfo","pageSize","currentPage","total","activeTab","diffTabData","tabData","selectNode","attrsTableColomnOptions","computed","setUploadActionHeader","uploadToken","split","nowTab","find","_","title","result","methods","renderActionButton","selectSystemDesignVersion","getSystemDesignVersion","formatTreeData","array","map","name","level","children","expand","selectTreeNode","node","r_guid","queryPackages","pageChange","pageSizeChange","genFilesTreedata","currentDir","filesArray","forEach","targetNode","dir","formatChildrenData","files","Array","path","isDir","obj","render","expandNode","getFiles","rowClick","row","getTabDatas","diff_conf_file","changeStatus","status","showFilesModal","handleDelete","handleStatusChange","JSON","parse","stringify","diffFile","f","getKeys","showTreeModal","type","closeModal","onOk","key","join","closeTreeModal","checkboxChange","splice","tabChange","tabName","updateRoutine","routine","val","saveAttr","saveDiffConfigEnumCodes","code","created","fetchData","getAllCITypesByLayerWithAttr","getAllCiTypesByCatalog","getAllSystemEnumCodes","_vm","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","on","model","callback","$$v","expression","_l","version","fixed_date","saveConfigFiles","start_file","stop_file","deploy_file","item","staticRenderFns","injectStyle","context","__vue_template_functional__","__vue_styles__","__vue_scopeId__","__vue_module_identifier__","Component"],"mappings":"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","file":"js/chunk-19236406.6156c14e.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ab026ca6\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../../node_modules/sass-loader/lib/loader.js!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./artifact-management.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-loader/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"23724bd9\", content, true, {});","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n","module.exports = require(\"core-js/library/fn/get-iterator\");","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n","import _Array$isArray from \"../../core-js/array/is-array\";\nexport default function _arrayWithHoles(arr) {\n  if (_Array$isArray(arr)) return arr;\n}","import _getIterator from \"../../core-js/get-iterator\";\nexport default function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = _getIterator(arr), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".artifact-management[data-v-ab026ca6]{padding:20px}.artifact-management-top-card[data-v-ab026ca6]{padding-bottom:40px}.artifact-management-bottom-card[data-v-ab026ca6]{margin-top:30px}.artifact-management-tree-body[data-v-ab026ca6]{position:relative}.artifact-management-save-button[data-v-ab026ca6]{float:right;margin-top:10px}.artifact-management-files-card[data-v-ab026ca6]{margin-top:10px}.artifact-management-files-card[data-v-ab026ca6]:first-of-type{margin-top:0}\", \"\"]);\n\n// exports\n","<template>\r\n  <Row class=\"artifact-management\">\r\n    <Col span=\"6\">\r\n      <Card>\r\n        <p slot=\"title\">系统设计版本</p>\r\n        <Select\r\n          @on-change=\"selectSystemDesignVersion\"\r\n          label-in-name\r\n          v-model=\"systemDesignVersion\"\r\n        >\r\n          <Option\r\n            v-for=\"version in systemDesignVersions\"\r\n            :value=\"version.guid || ''\"\r\n            :key=\"version.guid\"\r\n            >{{\r\n              version.fixed_date\r\n                ? `${version.name}[${version.fixed_date}]`\r\n                : version.name\r\n            }}</Option\r\n          >\r\n        </Select>\r\n      </Card>\r\n      <Card class=\"artifact-management-bottom-card\">\r\n        <p slot=\"title\">系统设计列表</p>\r\n        <div class=\"artifact-management-tree-body\">\r\n          <Tree :data=\"treeData\" @on-select-change=\"selectTreeNode\"></Tree>\r\n          <Spin size=\"large\" fix v-if=\"treeLoading\">\r\n            <Icon type=\"ios-loading\" size=\"24\" class=\"spin-icon-load\"></Icon>\r\n            <div>loading...</div>\r\n          </Spin>\r\n        </div>\r\n      </Card>\r\n    </Col>\r\n    <Col span=\"17\" offset=\"1\">\r\n      <Card v-if=\"guid\" class=\"artifact-management-top-card\">\r\n        <Upload\r\n          :action=\"`/artifact/unit-designs/${guid}/packages/upload`\"\r\n          :headers=\"setUploadActionHeader\"\r\n          :on-success=\"queryPackages\"\r\n          slot=\"title\"\r\n        >\r\n          <Button icon=\"ios-cloud-upload-outline\">上传新包</Button>\r\n        </Upload>\r\n        <SimpleTable\r\n          :loading=\"tableLoading\"\r\n          :columns=\"tableColumns\"\r\n          :data=\"tableData\"\r\n          :page=\"pageInfo\"\r\n          @pageChange=\"pageChange\"\r\n          @pageSizeChange=\"pageSizeChange\"\r\n          @rowClick=\"rowClick\"\r\n        ></SimpleTable>\r\n        <Modal\r\n          v-model=\"isShowFilesModal\"\r\n          title=\"脚本配置\"\r\n          okText=\"保存\"\r\n          :loading=\"loadingForSave\"\r\n          @on-ok=\"saveConfigFiles\"\r\n          @on-cancel=\"closeModal\"\r\n        >\r\n          <Card class=\"artifact-management-files-card\">\r\n            <div slot=\"title\">\r\n              <span>差异化文件</span>\r\n              <Button @click=\"() => showTreeModal(0)\" size=\"small\"\r\n                >选择文件</Button\r\n              >\r\n            </div>\r\n            <span>{{ currentPackage.diff_conf_file || \"未选择\" }}</span>\r\n          </Card>\r\n          <Card class=\"artifact-management-files-card\">\r\n            <div slot=\"title\">\r\n              <span>启动脚本</span>\r\n              <Button @click=\"() => showTreeModal(1)\" size=\"small\"\r\n                >选择文件</Button\r\n              >\r\n            </div>\r\n            <span>{{ currentPackage.start_file || \"未选择\" }}</span>\r\n          </Card>\r\n          <Card class=\"artifact-management-files-card\">\r\n            <div slot=\"title\">\r\n              <span>停止脚本</span>\r\n              <Button @click=\"() => showTreeModal(2)\" size=\"small\"\r\n                >选择文件</Button\r\n              >\r\n            </div>\r\n            <span>{{ currentPackage.stop_file || \"未选择\" }}</span>\r\n          </Card>\r\n          <Card class=\"artifact-management-files-card\">\r\n            <div slot=\"title\">\r\n              <span>部署脚本</span>\r\n              <Button @click=\"() => showTreeModal(3)\" size=\"small\"\r\n                >选择文件</Button\r\n              >\r\n            </div>\r\n            <span>{{ currentPackage.deploy_file || \"未选择\" }}</span>\r\n          </Card>\r\n        </Modal>\r\n        <Modal\r\n          v-model=\"isShowTreeModal\"\r\n          :title=\"currentTreeModal.title\"\r\n          @on-ok=\"onOk\"\r\n          @on-cancel=\"closeTreeModal\"\r\n        >\r\n          <RadioGroup v-model=\"selectFile\">\r\n            <Tree :data=\"filesTreeData\" @on-toggle-expand=\"expandNode\"></Tree>\r\n          </RadioGroup>\r\n        </Modal>\r\n      </Card>\r\n      <Card\r\n        v-if=\"tabData.length ? true : false\"\r\n        class=\"artifact-management-bottom-card artifact-management-top-card\"\r\n      >\r\n        <Tabs v-model=\"activeTab\" @on-click=\"tabChange\">\r\n          <TabPane\r\n            v-for=\"(item, index) in tabData\"\r\n            :label=\"item.title\"\r\n            :name=\"item.title\"\r\n            :key=\"index\"\r\n          >\r\n            <Table\r\n              :data=\"item.tableData || []\"\r\n              :columns=\"attrsTableColomnOptions\"\r\n            ></Table>\r\n          </TabPane>\r\n        </Tabs>\r\n      </Card>\r\n    </Col>\r\n  </Row>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getPackageCiTypeId,\r\n  getAllCITypesByLayerWithAttr,\r\n  getSystemDesignVersions,\r\n  getAllCiTypesByCatalog,\r\n  getSystemDesignVersion,\r\n  queryPackages,\r\n  deleteCiDatas,\r\n  operateCiState,\r\n  getFiles,\r\n  getKeys,\r\n  saveConfigFiles,\r\n  saveDiffConfigEnumCodes,\r\n  getDiffConfigEnumCodes,\r\n  getAllSystemEnumCodes\r\n} from \"@/api/server.js\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      packageCiType: 0,\r\n      statusOperations: [],\r\n      systemDesignVersions: [],\r\n      systemDesignVersion: \"\",\r\n      ciTypesObj: {},\r\n      ciTypeAttributeObj: {},\r\n      ciTypes: [],\r\n      treeData: [],\r\n      treeLoading: false,\r\n      loadingForSave: false,\r\n      selectFile: \"\",\r\n      filesTreeData: [],\r\n      guid: \"\",\r\n      currentPackage: {},\r\n      packageId: \"\",\r\n      isShowFilesModal: false,\r\n      isShowTreeModal: false,\r\n      treeModalOpt: [\r\n        {\r\n          title: \"选择差异化文件\",\r\n          key: \"diff_conf_file\",\r\n          inputType: \"checkbox\"\r\n        },\r\n        {\r\n          title: \"选择启动脚本\",\r\n          key: \"start_file\",\r\n          inputType: \"radio\"\r\n        },\r\n        {\r\n          title: \"选择停止脚本\",\r\n          key: \"stop_file\",\r\n          inputType: \"radio\"\r\n        },\r\n        {\r\n          title: \"选择部署脚本\",\r\n          key: \"deploy_file\",\r\n          inputType: \"radio\"\r\n        }\r\n      ],\r\n      currentTreeModal: {},\r\n      tableLoading: false,\r\n      tableData: [],\r\n      tableColumns: [\r\n        {\r\n          title: \"包名\",\r\n          key: \"name\"\r\n        },\r\n        {\r\n          title: \"上传时间\",\r\n          width: 150,\r\n          key: \"upload_time\"\r\n        },\r\n        {\r\n          title: \"MD5值\",\r\n          key: \"md5_value\"\r\n        },\r\n        {\r\n          title: \"上传人\",\r\n          key: \"updated_by\"\r\n        },\r\n        {\r\n          title: \"差异化文件\",\r\n          key: \"diff_conf_file\"\r\n        },\r\n        {\r\n          title: \"启动脚本\",\r\n          key: \"start_file\"\r\n        },\r\n        {\r\n          title: \"停止脚本\",\r\n          key: \"stop_file\"\r\n        },\r\n        {\r\n          title: \"部署脚本\",\r\n          key: \"deploy_file\"\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          key: \"state\",\r\n          width: 150,\r\n          render: (h, params) => {\r\n            return (\r\n              <div style=\"padding-top:5px\">\r\n                {this.renderActionButton(params)}\r\n              </div>\r\n            );\r\n          }\r\n        }\r\n      ],\r\n      pageInfo: {\r\n        pageSize: 5,\r\n        currentPage: 1,\r\n        total: 0\r\n      },\r\n      activeTab: \"\",\r\n      diffTabData: \"\",\r\n      tabData: [],\r\n      selectNode: [],\r\n      attrsTableColomnOptions: [\r\n        {\r\n          title: \"序号\",\r\n          key: \"index\",\r\n          width: 60\r\n        },\r\n        {\r\n          title: \"文件行号\",\r\n          key: \"line\"\r\n        },\r\n        {\r\n          title: \"properties-key\",\r\n          key: \"key\"\r\n        },\r\n        {\r\n          title: \"CMDB-ATTR\",\r\n          render: (h, params) => {\r\n            return params.row.attrInputValue ? (\r\n              <AttrInput\r\n                style=\"margin-top:5px;\"\r\n                allCiTypes={this.ciTypes}\r\n                rootCiType={15}\r\n                isReadOnly={true}\r\n                ciTypesObj={this.ciTypesObj}\r\n                ciTypeAttributeObj={this.ciTypeAttributeObj}\r\n                sourceData={params.row.attrInputValue}\r\n                onUpdateRoutine={val => this.updateRoutine(val, params.index)}\r\n              />\r\n            ) : (\r\n              <div style=\"align-items:center;display:flex;\">\r\n                <AttrInput\r\n                  style=\"margin-top:5px;width:calc(100% - 55px);\"\r\n                  allCiTypes={this.ciTypes}\r\n                  rootCiType={15}\r\n                  ciTypesObj={this.ciTypesObj}\r\n                  ciTypeAttributeObj={this.ciTypeAttributeObj}\r\n                  onUpdateRoutine={val => this.updateRoutine(val, params.index)}\r\n                />\r\n                <Button\r\n                  size=\"small\"\r\n                  type=\"primary\"\r\n                  style=\"margin-left:10px\"\r\n                  onClick={() => this.saveAttr(params.index)}\r\n                >\r\n                  保存\r\n                </Button>\r\n              </div>\r\n            );\r\n          }\r\n        }\r\n      ]\r\n    };\r\n  },\r\n  computed: {\r\n    setUploadActionHeader() {\r\n      let uploadToken = document.cookie\r\n        .split(\";\")\r\n        .find(i => i.indexOf(\"XSRF-TOKEN\") !== -1);\r\n      return {\r\n        \"X-XSRF-TOKEN\": uploadToken && uploadToken.split(\"=\")[1]\r\n      };\r\n    },\r\n    nowTab() {\r\n      let result = 0;\r\n      this.tabData.find((_, i) => {\r\n        if (_.title === this.activeTab) {\r\n          result = i;\r\n          return true;\r\n        }\r\n      });\r\n      return result;\r\n    }\r\n  },\r\n  methods: {\r\n    renderActionButton(params) {\r\n      const row = params.row;\r\n      return this.statusOperations\r\n        .filter(_ => row.nextOperations.indexOf(_.type) >= 0)\r\n        .map(_ => {\r\n          return (\r\n            <Button\r\n              {...{ props: { ..._.props } }}\r\n              style=\"margin-right:5px;margin-bottom:5px;\"\r\n              onClick={() => this.changeStatus(row, _.type)}\r\n            >\r\n              {_.label}\r\n            </Button>\r\n          );\r\n        });\r\n    },\r\n    async fetchData() {\r\n      const [sysData, packageCiType] = await Promise.all([\r\n        getSystemDesignVersions(),\r\n        getPackageCiTypeId()\r\n      ]);\r\n      if (sysData.status === \"OK\" && sysData.data.contents instanceof Array) {\r\n        this.systemDesignVersions = sysData.data.contents.map(_ => _.data);\r\n      }\r\n      if (packageCiType.status === \"OK\") {\r\n        this.packageCiType = packageCiType.data;\r\n      }\r\n    },\r\n    async getAllCITypesByLayerWithAttr() {\r\n      let { status, data, message } = await getAllCITypesByLayerWithAttr([\r\n        \"notCreated\",\r\n        \"created\",\r\n        \"dirty\",\r\n        \"decommissioned\"\r\n      ]);\r\n      if (status === \"OK\") {\r\n        let ciTypes = {};\r\n        let ciTypeAttrs = {};\r\n        data.forEach(layer => {\r\n          if (layer.ciTypes instanceof Array) {\r\n            layer.ciTypes.forEach(citype => {\r\n              ciTypes[citype.ciTypeId] = citype;\r\n              if (citype.attributes instanceof Array) {\r\n                citype.attributes.forEach(citypeAttr => {\r\n                  ciTypeAttrs[citypeAttr.ciTypeAttrId] = citypeAttr;\r\n                });\r\n              }\r\n            });\r\n          }\r\n        });\r\n        this.ciTypesObj = ciTypes;\r\n        this.ciTypeAttributeObj = ciTypeAttrs;\r\n      }\r\n    },\r\n    async getAllCiTypesByCatalog() {\r\n      let { status, data, message } = await getAllCiTypesByCatalog();\r\n      if (status === \"OK\") {\r\n        this.ciTypes = data;\r\n      }\r\n    },\r\n    async getSystemDesignVersion(guid) {\r\n      this.treeLoading = true;\r\n      let { status, data, message } = await getSystemDesignVersion(guid);\r\n      if (status === \"OK\") {\r\n        this.treeData = this.formatTreeData(data, 1);\r\n        this.treeLoading = false;\r\n      }\r\n    },\r\n    async queryPackages() {\r\n      this.tableLoading = true;\r\n      let { status, data, message } = await queryPackages(this.guid, {\r\n        sorting: {\r\n          asc: false,\r\n          field: \"upload_time\"\r\n        },\r\n        paging: true,\r\n        pageable: {\r\n          pageSize: this.pageInfo.pageSize,\r\n          startIndex: (this.pageInfo.currentPage - 1) * this.pageInfo.pageSize\r\n        }\r\n      });\r\n      if (status === \"OK\") {\r\n        this.tableLoading = false;\r\n        this.tableData = data.contents.map(_ => {\r\n          return {\r\n            ..._.data,\r\n            nextOperations: _.meta.nextOperations || []\r\n          };\r\n        });\r\n        const { pageSize, totalRows: total } = data.pageInfo;\r\n        const currentPage = this.pageInfo.currentPage;\r\n        this.pageInfo = { currentPage, pageSize, total };\r\n      }\r\n    },\r\n    async getFiles(packageId, currentDir) {\r\n      this.packageId = packageId;\r\n      let { status, data, message } = await getFiles(this.guid, packageId, {\r\n        currentDir\r\n      });\r\n      if (status === \"OK\") {\r\n        this.isShowFilesModal = true;\r\n        this.genFilesTreedata({ files: data.outputs[0].files, currentDir });\r\n      }\r\n    },\r\n    async getKeys(options) {\r\n      if (!options) return;\r\n      let { status, data, message } = await getKeys(this.guid, this.packageId, {\r\n        filePath: options.path\r\n      });\r\n      if (status === \"OK\") {\r\n        const diffConfigEnums = await getDiffConfigEnumCodes();\r\n        if (diffConfigEnums.status === \"OK\") {\r\n          const result = data.outputs[0].config_key_infos.map((_, i) => {\r\n            _.index = i + 1;\r\n            const found = diffConfigEnums.data.find(\r\n              item => item.code === _.key\r\n            );\r\n            if (found) {\r\n              _.attrInputValue = found.value;\r\n            }\r\n            return _;\r\n          });\r\n          this.$set(options, \"tableData\", result);\r\n        }\r\n      }\r\n    },\r\n    async saveConfigFiles() {\r\n      this.loadingForSave = true;\r\n      const obj = {\r\n        configFilesWithPath: this.diffTabData.split(\"|\"),\r\n        startFile: this.currentPackage.start_file || \"\",\r\n        stopFile: this.currentPackage.stop_file || \"\",\r\n        deployFile: this.currentPackage.deploy_file || \"\"\r\n      };\r\n      let { status, data, message } = await saveConfigFiles(\r\n        this.guid,\r\n        this.packageId,\r\n        obj\r\n      );\r\n      if (status === \"OK\") {\r\n        this.loadingForSave = false;\r\n        this.$Notice.success({\r\n          title: \"保存成功\"\r\n        });\r\n      }\r\n      this.queryPackages();\r\n      this.getTabDatas(this.diffTabData);\r\n    },\r\n    async saveDiffConfigEnumCodes(obj) {\r\n      let { status, data, message } = await saveDiffConfigEnumCodes(obj);\r\n      if (status === \"OK\") {\r\n        this.$Notice.success({\r\n          title: \"保存成功\"\r\n        });\r\n        this.getKeys(this.tabData[this.nowTab]);\r\n      }\r\n    },\r\n    selectSystemDesignVersion(guid) {\r\n      this.getSystemDesignVersion(guid);\r\n    },\r\n    formatTreeData(array, level) {\r\n      return array.map(_ => {\r\n        _.title = _.data.name;\r\n        _.level = level;\r\n        if (_.children && _.children.length) {\r\n          _.expand = true;\r\n          _.children = this.formatTreeData(_.children, level + 1);\r\n        }\r\n        return _;\r\n      });\r\n    },\r\n    selectTreeNode(node) {\r\n      if (node.length && node[0].level === 3) {\r\n        this.guid = node[0].data.r_guid;\r\n        this.queryPackages();\r\n        this.tabData = [];\r\n      }\r\n    },\r\n    pageChange(currentPage) {\r\n      this.pageInfo.currentPage = currentPage;\r\n      this.queryPackages();\r\n    },\r\n    pageSizeChange(pageSize) {\r\n      this.pageInfo.pageSize = pageSize;\r\n      this.queryPackages();\r\n    },\r\n    genFilesTreedata(data) {\r\n      const { files, currentDir } = data;\r\n      if (currentDir) {\r\n        const filesArray = currentDir.split(\"/\");\r\n        let targetNode = this.filesTreeData;\r\n        filesArray.forEach((dir, index) => {\r\n          if (index) {\r\n            targetNode = targetNode.children;\r\n          }\r\n          targetNode.find(_ => {\r\n            if (dir === _.title) {\r\n              targetNode = _;\r\n              return true;\r\n            }\r\n          });\r\n        });\r\n        targetNode.children = this.formatChildrenData({\r\n          files,\r\n          currentDir,\r\n          level: targetNode.level + 1\r\n        });\r\n      } else {\r\n        this.filesTreeData = this.formatChildrenData({\r\n          files,\r\n          currentDir,\r\n          level: 1\r\n        });\r\n      }\r\n    },\r\n    formatChildrenData(val) {\r\n      const { files, currentDir, level } = val;\r\n      if (!(files instanceof Array)) {\r\n        return;\r\n      }\r\n      const tagName = this.currentTreeModal.inputType;\r\n      return files.map(_ => {\r\n        let obj = {\r\n          title: _.name,\r\n          path: currentDir ? `${currentDir}/${_.name}` : _.name,\r\n          level: level\r\n        };\r\n        if (_.isDir) {\r\n          obj.children = [{}];\r\n        } else {\r\n          obj.render = (h, params) => {\r\n            return this.currentTreeModal.inputType === \"checkbox\" ? (\r\n              <Checkbox\r\n                on-on-change={value => this.checkboxChange(value, params.data)}\r\n              >\r\n                <span>{params.data.title}</span>\r\n              </Checkbox>\r\n            ) : (\r\n              <Radio label={params.data.path}>\r\n                <span>{params.data.title}</span>\r\n              </Radio>\r\n            );\r\n          };\r\n        }\r\n        return obj;\r\n      });\r\n    },\r\n    expandNode(node) {\r\n      if (node.expand && !node.children[0].title) {\r\n        this.getFiles(this.packageId, node.path);\r\n      }\r\n    },\r\n    rowClick(row) {\r\n      this.packageId = row.guid;\r\n      this.getTabDatas(row.diff_conf_file);\r\n    },\r\n    changeStatus(row, status) {\r\n      switch (status) {\r\n        case \"update\":\r\n          this.showFilesModal(row);\r\n          break;\r\n        case \"delete\":\r\n          this.handleDelete(row, status);\r\n          break;\r\n        default:\r\n          this.handleStatusChange(row, status);\r\n          break;\r\n      }\r\n    },\r\n    async handleDelete(row) {\r\n      this.$Modal.confirm({\r\n        title: \"确认删除？\",\r\n        \"z-index\": 1000000,\r\n        onOk: async () => {\r\n          const { status, data, message } = await deleteCiDatas({\r\n            id: this.packageCiType,\r\n            deleteData: [row.guid]\r\n          });\r\n          if (status === \"OK\") {\r\n            this.$Notice.success({\r\n              title: \"Delete data Success\",\r\n              desc: message\r\n            });\r\n            this.queryPackages();\r\n          }\r\n        }\r\n      });\r\n    },\r\n    async handleStatusChange(row, state) {\r\n      const { data, status, message } = await operateCiState(\r\n        this.packageCiType,\r\n        row.guid,\r\n        state\r\n      );\r\n      if (status === \"OK\") {\r\n        this.$Notice.success({\r\n          title: state,\r\n          desc: message\r\n        });\r\n        this.queryPackages();\r\n      }\r\n    },\r\n    showFilesModal(row) {\r\n      this.tabData = [];\r\n      this.currentPackage = JSON.parse(JSON.stringify(row));\r\n      this.packageId = this.currentPackage.guid;\r\n      this.diffTabData = row.diff_conf_file || \"\";\r\n      this.isShowFilesModal = true;\r\n    },\r\n\r\n    getTabDatas(diffFile) {\r\n      if (diffFile) {\r\n        const files = diffFile.split(\"|\");\r\n        this.tabData = files.map(_ => {\r\n          const f = _.split(\"/\");\r\n          return {\r\n            path: _,\r\n            title: f[f.length - 1]\r\n          };\r\n        });\r\n        this.activeTab = this.tabData.length ? this.tabData[0].title : \"\";\r\n        this.getKeys(this.tabData[0]);\r\n      } else {\r\n        this.tabData = [];\r\n      }\r\n    },\r\n    showTreeModal(type) {\r\n      this.currentTreeModal = this.treeModalOpt[type];\r\n      if (!this.filesTreeData.length)\r\n        this.getFiles(this.currentPackage.guid, \"\");\r\n      this.isShowTreeModal = true;\r\n    },\r\n    closeModal() {\r\n      this.currentPackage = {};\r\n    },\r\n    onOk() {\r\n      if (this.currentTreeModal.key === \"diff_conf_file\") {\r\n        this.diffTabData = \"\";\r\n        let files = [];\r\n        this.selectNode.forEach(_ => {\r\n          files.push(\"/\" + _.path);\r\n        });\r\n        this.diffTabData = files.join(\"|\");\r\n        this.currentPackage.diff_conf_file = files.join(\"|\");\r\n        this.selectNode = [];\r\n        this.filesTreeData = [];\r\n      } else {\r\n        this.currentPackage[this.currentTreeModal.key] = \"/\" + this.selectFile;\r\n      }\r\n    },\r\n    closeTreeModal() {\r\n      this.selectNode = [];\r\n      this.filesTreeData = [];\r\n    },\r\n    checkboxChange(value, data) {\r\n      if (value) {\r\n        this.selectNode.push(data);\r\n      } else {\r\n        let i = 0;\r\n        this.selectNode.find((_, index) => {\r\n          if (_.path === data.path) {\r\n            i = index;\r\n            return true;\r\n          }\r\n        });\r\n        this.selectNode.splice(i, 1);\r\n      }\r\n    },\r\n    tabChange(tabName) {\r\n      this.tabData.find(_ => {\r\n        if (_.title === tabName && !(_.tableData instanceof Array)) {\r\n          this.getKeys(_);\r\n          return true;\r\n        }\r\n      });\r\n    },\r\n    updateRoutine(val, row) {\r\n      this.tabData[this.nowTab].tableData[row].routine = JSON.stringify(val);\r\n    },\r\n    saveAttr(row) {\r\n      this.saveDiffConfigEnumCodes({\r\n        code: this.tabData[this.nowTab].tableData[row].key,\r\n        value: this.tabData[this.nowTab].tableData[row].routine\r\n      });\r\n    },\r\n    async getAllSystemEnumCodes() {\r\n      const { status, data, message } = await getAllSystemEnumCodes({\r\n        filters: [\r\n          {\r\n            name: \"cat.catName\",\r\n            operator: \"eq\",\r\n            value: \"state_transition_operation\"\r\n          }\r\n        ],\r\n        paging: false\r\n      });\r\n      if (status === \"OK\" && data.contents instanceof Array) {\r\n        const buttonTypes = {\r\n          confirm: \"info\",\r\n          delete: \"error\",\r\n          discard: \"warning\",\r\n          update: \"primary\"\r\n        };\r\n        this.statusOperations = data.contents\r\n          .filter(\r\n            _ =>\r\n              _.code === \"confirm\" ||\r\n              _.code === \"delete\" ||\r\n              _.code === \"discard\" ||\r\n              _.code === \"update\"\r\n          )\r\n          .map(_ => {\r\n            return {\r\n              type: _.code,\r\n              label: _.code !== \"update\" ? _.value : \"配置\",\r\n              props: {\r\n                type: buttonTypes[_.code] || \"info\",\r\n                size: \"small\"\r\n              },\r\n              actionType: _.code\r\n            };\r\n          });\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchData();\r\n    this.getAllCITypesByLayerWithAttr();\r\n    this.getAllCiTypesByCatalog();\r\n    this.getAllSystemEnumCodes();\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.artifact-management {\r\n  padding: 20px;\r\n\r\n  &-top-card {\r\n    padding-bottom: 40px;\r\n  }\r\n\r\n  &-bottom-card {\r\n    margin-top: 30px;\r\n  }\r\n\r\n  &-tree-body {\r\n    position: relative;\r\n  }\r\n\r\n  &-save-button {\r\n    float: right;\r\n    margin-top: 10px;\r\n  }\r\n\r\n  &-files-card {\r\n    margin-top: 10px;\r\n\r\n    &:first-of-type {\r\n      margin-top: 0;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Row',{staticClass:\"artifact-management\"},[_c('Col',{attrs:{\"span\":\"6\"}},[_c('Card',[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"系统设计版本\")]),_vm._v(\" \"),_c('Select',{attrs:{\"label-in-name\":\"\"},on:{\"on-change\":_vm.selectSystemDesignVersion},model:{value:(_vm.systemDesignVersion),callback:function ($$v) {_vm.systemDesignVersion=$$v},expression:\"systemDesignVersion\"}},_vm._l((_vm.systemDesignVersions),function(version){return _c('Option',{key:version.guid,attrs:{\"value\":version.guid || ''}},[_vm._v(_vm._s(version.fixed_date\n              ? ((version.name) + \"[\" + (version.fixed_date) + \"]\")\n              : version.name))])}),1)],1),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-bottom-card\"},[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"系统设计列表\")]),_vm._v(\" \"),_c('div',{staticClass:\"artifact-management-tree-body\"},[_c('Tree',{attrs:{\"data\":_vm.treeData},on:{\"on-select-change\":_vm.selectTreeNode}}),_vm._v(\" \"),(_vm.treeLoading)?_c('Spin',{attrs:{\"size\":\"large\",\"fix\":\"\"}},[_c('Icon',{staticClass:\"spin-icon-load\",attrs:{\"type\":\"ios-loading\",\"size\":\"24\"}}),_vm._v(\" \"),_c('div',[_vm._v(\"loading...\")])],1):_vm._e()],1)])],1),_vm._v(\" \"),_c('Col',{attrs:{\"span\":\"17\",\"offset\":\"1\"}},[(_vm.guid)?_c('Card',{staticClass:\"artifact-management-top-card\"},[_c('Upload',{attrs:{\"slot\":\"title\",\"action\":(\"/artifact/unit-designs/\" + _vm.guid + \"/packages/upload\"),\"headers\":_vm.setUploadActionHeader,\"on-success\":_vm.queryPackages},slot:\"title\"},[_c('Button',{attrs:{\"icon\":\"ios-cloud-upload-outline\"}},[_vm._v(\"上传新包\")])],1),_vm._v(\" \"),_c('SimpleTable',{attrs:{\"loading\":_vm.tableLoading,\"columns\":_vm.tableColumns,\"data\":_vm.tableData,\"page\":_vm.pageInfo},on:{\"pageChange\":_vm.pageChange,\"pageSizeChange\":_vm.pageSizeChange,\"rowClick\":_vm.rowClick}}),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"脚本配置\",\"okText\":\"保存\",\"loading\":_vm.loadingForSave},on:{\"on-ok\":_vm.saveConfigFiles,\"on-cancel\":_vm.closeModal},model:{value:(_vm.isShowFilesModal),callback:function ($$v) {_vm.isShowFilesModal=$$v},expression:\"isShowFilesModal\"}},[_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"差异化文件\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(0); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.diff_conf_file || \"未选择\"))])]),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"启动脚本\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(1); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.start_file || \"未选择\"))])]),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"停止脚本\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(2); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.stop_file || \"未选择\"))])]),_vm._v(\" \"),_c('Card',{staticClass:\"artifact-management-files-card\"},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',[_vm._v(\"部署脚本\")]),_vm._v(\" \"),_c('Button',{attrs:{\"size\":\"small\"},on:{\"click\":function () { return _vm.showTreeModal(3); }}},[_vm._v(\"选择文件\")])],1),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.currentPackage.deploy_file || \"未选择\"))])])],1),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":_vm.currentTreeModal.title},on:{\"on-ok\":_vm.onOk,\"on-cancel\":_vm.closeTreeModal},model:{value:(_vm.isShowTreeModal),callback:function ($$v) {_vm.isShowTreeModal=$$v},expression:\"isShowTreeModal\"}},[_c('RadioGroup',{model:{value:(_vm.selectFile),callback:function ($$v) {_vm.selectFile=$$v},expression:\"selectFile\"}},[_c('Tree',{attrs:{\"data\":_vm.filesTreeData},on:{\"on-toggle-expand\":_vm.expandNode}})],1)],1)],1):_vm._e(),_vm._v(\" \"),(_vm.tabData.length ? true : false)?_c('Card',{staticClass:\"artifact-management-bottom-card artifact-management-top-card\"},[_c('Tabs',{on:{\"on-click\":_vm.tabChange},model:{value:(_vm.activeTab),callback:function ($$v) {_vm.activeTab=$$v},expression:\"activeTab\"}},_vm._l((_vm.tabData),function(item,index){return _c('TabPane',{key:index,attrs:{\"label\":item.title,\"name\":item.title}},[_c('Table',{attrs:{\"data\":item.tableData || [],\"columns\":_vm.attrsTableColomnOptions}})],1)}),1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }","function injectStyle (context) {\n  require(\"!!vue-loader/node_modules/vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ab026ca6\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!sass-loader!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./artifact-management.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./artifact-management.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./artifact-management.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ab026ca6\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./artifact-management.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-ab026ca6\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n"],"sourceRoot":""}