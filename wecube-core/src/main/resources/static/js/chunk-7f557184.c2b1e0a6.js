(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f557184"],{"26e5":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".ivu-tag[data-v-671692c8]{display:block;border:1px dashed #515a61!important}.ivu-tag .ivu-tag-text[data-v-671692c8]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.role-item .ivu-tag[data-v-671692c8]{display:inline-block;width:65%}.data-permissions[data-v-671692c8]{width:100%;height:30px;border:1px dashed gray;padding-left:5px;padding-right:5px;border-radius:5px;margin-bottom:5px}.ciTypes-options[data-v-671692c8]{float:right;line-height:30px}.ciTypes[data-v-671692c8]{float:left;line-height:30px}.ciTypes-options .ivu-checkbox-indeterminate .ivu-checkbox-inner[data-v-671692c8]{background-color:#4ee643}.ciTypes-options .ivu-checkbox-disabled.ivu-checkbox-checked .ivu-checkbox-inner[data-v-671692c8]{background-color:#2d8cf0}",""])},5118:function(e,t,n){(function(e){var s="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(i.call(setTimeout,s,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,s,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(s,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("24aa"))},6017:function(e,t,n){(function(e,t){(function(e,n){"use strict";if(!e.setImmediate){var s,i=1,r={},a=!1,o=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?f():m()?h():e.MessageChannel?b():o&&"onreadystatechange"in o.createElement("script")?v():y(),c.setImmediate=l,c.clearImmediate=d}function l(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return r[i]=a,s(i),i++}function d(e){delete r[e]}function u(e){var t=e.callback,s=e.args;switch(s.length){case 0:t();break;case 1:t(s[0]);break;case 2:t(s[0],s[1]);break;case 3:t(s[0],s[1],s[2]);break;default:t.apply(n,s);break}}function p(e){if(a)setTimeout(p,0,e);else{var t=r[e];if(t){a=!0;try{u(t)}finally{d(e),a=!1}}}}function f(){s=function(e){t.nextTick(function(){p(e)})}}function m(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function h(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&p(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}function b(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;p(t)},s=function(t){e.port2.postMessage(t)}}function v(){var e=o.documentElement;s=function(t){var n=o.createElement("script");n.onreadystatechange=function(){p(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function y(){s=function(e){setTimeout(p,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,n("24aa"),n("f28c"))},7839:function(e,t,n){var s=n("26e5");"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var i=n("2fb2").default;i("da0dc82a",s,!0,{})},8941:function(e,t,n){"use strict";n.r(t);n("8e6e"),n("456d"),n("ac6a"),n("7f7f");var s=n("bd86"),i=(n("6b54"),n("a481"),n("28a5"),n("7618")),r=(n("7514"),n("96cf"),n("3b8d")),a=n("ab33"),o=n("aa22"),c=n("2ce2");n("5118");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var u={data:function(){return{actionsType:[{actionCode:"creationPermission",type:"CREATION",actionName:"增"},{actionCode:"removalPermission",type:"REMOVAL",actionName:"删"},{actionCode:"modificationPermission",type:"MODIFICATION",actionName:"改"},{actionCode:"enquiryPermission",type:"ENQUIRY",actionName:"查"},{actionCode:"executionPermission",type:"EXECUTION",actionName:"执"}],users:[],roles:[],menus:[],dataPermissionDisabled:!1,menusForEdit:[],permissionEntryPoints:[],permissionEntryPointsForEdit:[],permissionEntryPointsBackup:[],addRoleModalVisible:!1,addUserModalVisible:!1,addedRoleValue:"",userManageModal:!1,permissionManageModal:!1,usersKeyBySelectedRole:[],allUsersForTransfer:[],selectedRole:0,transferTitles:["未选中用户","选中用户"],currentRoleId:0,ciTypePermissions:[],allMenusOriginResponse:[],transferStyle:{width:"300px"},currentRoleCiTypeId:"",outerActions:a["c"],innerActions:a["b"],ciTypeAttrsPermissions:[],ciTypeAttrsPermissionsBackUp:[],attrsPermissionsColumns:[],permissionsTableOptions:{},defaultColumns:[{title:"查询",key:"enquiryPermission",inputKey:"enquiryPermission",displaySeqNo:1,placeholder:"请选择",component:"WeSelect",options:[{label:"是",value:"Y"},{label:"否",value:"N"}]},{title:"新增",key:"creationPermission",inputKey:"creationPermission",displaySeqNo:2,placeholder:"请选择",component:"WeSelect",options:[{label:"是",value:"Y"},{label:"否",value:"N"}]},{title:"修改",key:"modificationPermission",inputKey:"modificationPermission",displaySeqNo:3,placeholder:"请选择",component:"WeSelect",options:[{label:"是",value:"Y"},{label:"否",value:"N"}]},{title:"执行",key:"executionPermission",inputKey:"executionPermission",displaySeqNo:4,placeholder:"请选择",component:"WeSelect",options:[{label:"是",value:"Y"},{label:"否",value:"N"}]},{title:"删除",key:"removalPermission",inputKey:"removalPermission",displaySeqNo:5,placeholder:"请选择",component:"WeSelect",options:[{label:"是",value:"Y"},{label:"否",value:"N"}]}],seletedRows:[],addedUser:{}}},methods:{renderUserNameForTransfer:function(e){return e.label},openPermissionManageModal:function(e){this.currentRoleCiTypeId=e,this.permissionManageModal=!0,this.getAttrPermissions()},getAttrPermissions:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,s,c=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["Ib"])(this.currentRoleCiTypeId);case 2:t=e.sent,n=t.status,s=t.data,t.message,"OK"===n&&(this.ciTypeAttrsPermissionsBackUp=s.body,this.ciTypeAttrsPermissions=s.body.map(function(e){var t={},n=function(n){var r=s.header.find(function(e){return e.propertyName===n}),a=r&&"ref"===r.inputType;"object"===Object(i["a"])(e[n])&&null!==e[n]?t[n]={codeId:e[n].conditionValue&&a?e[n].conditionValue:e[n].conditionValue.split(",").map(function(e){return 1*e}),value:e[n].conditionValueObject&&e[n].conditionValueObject.map(function(e){return a?e.data.key_name:e.value}).toString().replace(",",";")||[]}:t[n]={codeId:e[n],value:"Y"===e[n]?"是":"否"}};for(var r in e)n(r);return t}),this.attrsPermissionsColumns=s.header.map(function(e,t){return d({},e,{title:e.name,key:e.propertyName,inputKey:e.propertyName,displaySeqNo:t+6,inputType:e.inputType,referenceId:e.referenceId,placeholder:e.name,ciType:{id:e.referenceId,name:e.name},type:"text"},a["a"][e.inputType],{isMultiple:"select"===e.inputType})}).concat(this.defaultColumns),this.attrsPermissionsColumns.forEach(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("select"!==t.inputType){e.next=6;break}return e.next=3,Object(o["ob"])(0,t.referenceId);case 3:n=e.sent,s=[],"OK"===n.status&&(s=n.data.map(function(e){return{value:e.codeId,label:e.value}}),c.$set(t,"options",s));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),exportHandler:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this.ciTypeAttrsPermissions.map(function(e){for(var t in e)e[t]=e[t].value;return e}),this.$refs.table.export({filename:"Permission Data",data:t});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),actionFun:function(e,t){switch(e){case"export":this.exportHandler();break;case"add":this.addHandler();break;case"edit":this.editHandler();break;case"save":this.saveHandler(t);break;case"delete":this.deleteHandler(t);break;case"cancel":this.cancelHandler();break;case"innerCancel":this.$refs.table.rowCancelHandler(t.weTableRowId);break;default:break}},saveHandler:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n,s,i,r,a,c,l,d,u,p,f,m=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=function(){m.outerActions.forEach(function(e){e.props.disabled=!("add"===e.actionType||"export"===e.actionType)}),m.$refs.table.setAllRowsUneditable(),m.$nextTick(function(){var e=m.$refs.table.$refs.table.$refs.tbody.objData;for(var t in e)e[t]._isChecked=!1,e[t]._isDisabled=!1})},s=JSON.parse(JSON.stringify(t)),i=s.filter(function(e){return e.isNewAddedRow}),r=s.filter(function(e){return!e.isNewAddedRow}),a=["creationPermission","enquiryPermission","executionPermission","grantPermission","modificationPermission","removalPermission","roleCiTypeId","roleCiTypeCtrlAttrId","callbackId"],!(i.length>0)){e.next=14;break}return i.forEach(function(e){e.callbackId=e["weTableRowId"],delete e.isNewAddedRow,delete e.isRowEditable,delete e.weTableForm,delete e.weTableRowId;var t=function(t){var n=a.find(function(e){return e===t});n||(e[t]={conditionValue:e[t].toString()})};for(var n in e)t(n)}),e.next=9,Object(o["p"])(this.currentRoleCiTypeId,i);case 9:c=e.sent,l=c.status,d=c.message,c.data,"OK"===l&&(this.$Notice.success({title:"Add permissions Success",desc:d}),this.getAttrPermissions(),this.getPermissions(!1,!0,this.currentRoleId),n());case 14:if(!(r.length>0)){e.next=23;break}return r.forEach(function(e){e.callbackId=e["weTableRowId"],delete e.isNewAddedRow,delete e.isRowEditable,delete e.weTableForm,delete e.weTableRowId;var t=m.ciTypeAttrsPermissionsBackUp.find(function(t){return t.roleCiTypeCtrlAttrId===e.roleCiTypeCtrlAttrId}),n=function(n){var s=a.find(function(e){return e===n});s||(e[n]={conditionValue:e[n].toString(),conditionId:t[n].conditionId})};for(var s in e)n(s)}),e.next=18,Object(o["Fc"])(this.currentRoleCiTypeId,r);case 18:u=e.sent,p=u.status,f=u.message,u.data,"OK"===p&&(this.$Notice.success({title:"Update permissions Success",desc:f}),this.getAttrPermissions(),this.getPermissions(!1,!0,this.currentRoleId));case 23:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),deleteHandler:function(e){var t=this;this.$Modal.confirm({title:"确认删除？","z-index":1e6,onOk:function(){var n=Object(r["a"])(regeneratorRuntime.mark(function n(){var s,i,r,a;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return s=e.map(function(e){return e.roleCiTypeCtrlAttrId}),n.next=3,Object(o["x"])(t.currentRoleCiTypeId,s);case 3:i=n.sent,r=i.status,a=i.message,i.data,"OK"===r&&(t.$Notice.success({title:"Delete Permissions Success",desc:a}),t.outerActions.forEach(function(e){e.props.disabled="save"===e.actionType||"edit"===e.actionType||"delete"===e.actionType}),t.getAttrPermissions());case 8:case"end":return n.stop()}},n)}));function s(){return n.apply(this,arguments)}return s}(),onCancel:function(){}}),document.querySelector(".ivu-modal-mask").click()},addHandler:function(){var e=this,t={};this.attrsPermissionsColumns.forEach(function(e){"multiSelect"===e.inputType||"multiRef"===e.inputType?t[e.inputKey]=[]:t[e.inputKey]=""}),t["isRowEditable"]=!0,t["isNewAddedRow"]=!0,t["weTableRowId"]=(new Date).getTime(),this.ciTypeAttrsPermissions.unshift(t),this.$nextTick(function(){e.$refs.table.pushNewAddedRowToSelections(),e.$refs.table.setCheckoutStatus(!0)}),this.outerActions.forEach(function(e){e.props.disabled="add"===e.actionType})},editHandler:function(){var e=this;this.$refs.table.swapRowEditable(!0),this.outerActions.forEach(function(e){"save"===e.actionType&&(e.props.disabled=!1)}),this.$nextTick(function(){e.$refs.table.setCheckoutStatus(!0)})},cancelHandler:function(){this.$refs.table.setAllRowsUneditable(),this.$refs.table.setCheckoutStatus(),this.outerActions&&this.outerActions.forEach(function(e){e.props.disabled=!("add"===e.actionType||"export"===e.actionType||"cancel"===e.actionType)})},onSelectedRowsChange:function(e,t){e.length>0?this.outerActions.forEach(function(e){e.props.disabled="add"===e.actionType}):this.outerActions.forEach(function(e){e.props.disabled=!("add"===e.actionType||"export"===e.actionType||"cancel"===e.actionType)}),this.seletedRows=e},cancelEdit:function(){this.permissionEntryPointsForEdit=[],this.cancelHandler()},ciTypesPermissionsHandler:function(e,t,n){this.setPermissionAction(!("Y"===e[t]),n,e.ciTypeId)},handleUserTransferChange:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n,s){var i,r,a,c,l,d;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("right"!==n){e.next=10;break}return e.next=3,Object(o["e"])(s,this.selectedRole);case 3:i=e.sent,r=i.status,i.data,a=i.message,"OK"===r&&(this.$Notice.success({title:"success",desc:a}),this.usersKeyBySelectedRole=t),e.next=17;break;case 10:return e.next=12,Object(o["mc"])(s,this.selectedRole);case 12:c=e.sent,l=c.status,c.data,d=c.message,"OK"===l&&(this.$Notice.success({title:"success",desc:d}),this.usersKeyBySelectedRole=t);case 17:case"end":return e.stop()}},e,this)}));function t(t,n,s){return e.apply(this,arguments)}return t}(),addRole:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.addedRoleValue){e.next=3;break}return this.$Notice.warning({title:"Warning",desc:"角色名不能为空"}),e.abrupt("return");case 3:return e.next=5,Object(o["c"])({roleName:this.addedRoleValue,description:this.addedRoleValue});case 5:t=e.sent,n=t.status,t.data,s=t.message,"OK"===n&&(this.$Notice.success({title:"success",desc:s}),this.getAllRoles());case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),addUser:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.addedUser.username){e.next=3;break}return this.$Notice.warning({title:"Warning",desc:"用户名不能为空"}),e.abrupt("return");case 3:return e.next=5,Object(o["d"])(this.addedUser);case 5:t=e.sent,n=t.status,t.data,s=t.message,"OK"===n&&(this.$Notice.success({title:"success",desc:s}),this.addedUser={},this.getAllUsers());case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getPermissions:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n,s){var i,r,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=a.length>3&&void 0!==a[3]&&a[3],!n){e.next=16;break}if(!i){e.next=8;break}return e.next=5,Object(o["Bb"])(s);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Object(o["Ab"])(s);case 10:e.t0=e.sent;case 11:r=e.t0,this.ciTypePermissions=r.data.ciTypePermissions,t?(this.permissionEntryPointsForEdit=[],this.menusPermissionSelected(this.menusForEdit,r.data.menuPermissions)):(this.permissionEntryPoints=[],this.menusPermissionSelected(this.menus,r.data.menuPermissions),this.ciTypePermissions=r.data.ciTypePermissions),e.next=17;break;case 16:t?this.menusPermissionSelected(this.menusForEdit):(this.menusPermissionSelected(this.menus),this.ciTypePermissions=[]);case 17:case"end":return e.stop()}},e,this)}));function t(t,n,s){return e.apply(this,arguments)}return t}(),handleUserClick:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n){var s,i,r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.currentRoleId=0,this.dataPermissionDisabled=!0,this.users.forEach(function(e){e.checked=!1,n===e.username&&(e.checked=t)}),e.next=5,Object(o["Jb"])(n);case 5:s=e.sent,i=s.status,r=s.data,s.message,this.getPermissions(!1,t,n,!0),"OK"===i&&this.roles.forEach(function(e){e.checked=!1;var n=r.find(function(t){return t.roleId===e.id});n&&(e.checked=t),a.menus=a.menusResponseHandeler(a.allMenusOriginResponse)});case 11:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),getAllUsers:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["T"])();case 2:t=e.sent,n=t.status,s=t.data,t.message,"OK"===n&&(this.users=s.map(function(e){return{id:e.userId,username:e.username,fullName:e.fullName,description:e.description,checked:!1,color:"#5cadff"}}));case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),openAddRoleModal:function(){this.addRoleModalVisible=!0},openAddUserModal:function(){this.addUserModalVisible=!0},menusPermissionSelected:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.forEach(function(e){e.children.forEach(function(e){var n=t.find(function(t){return e.code===t});e.checked=!!n}),e.indeterminate=!1,e.checked=!1})},handleRoleClick:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n){var s,i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.currentRoleId=n,this.dataPermissionDisabled=!1,this.menus=this.menusResponseHandeler(this.allMenusOriginResponse,!1),this.roles.forEach(function(e){e.checked=!1,n===e.id&&(e.checked=t)}),e.next=6,Object(o["Pb"])(n);case 6:s=e.sent,i=s.status,r=s.data,s.message,this.getPermissions(!1,t,n),"OK"===i&&this.users.forEach(function(e){e.checked=!1;var n=r.find(function(t){return t.username===e.username});n&&(e.checked=t)});case 12:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),handleMenuTreeCheck:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n){var s,i,r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=[],n.parentId?s.push(n.code):s=n.children.map(function(e){return e.code}),!n.checked){e.next=8;break}return e.next=5,Object(o["b"])(s,this.currentRoleId);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Object(o["jc"])(s,this.currentRoleId);case 10:e.t0=e.sent;case 11:i=e.t0,r=i.status,a=i.message,i.data,"OK"===r&&this.$Notice.success({title:"success",desc:a}),this.getPermissions(!0,!0,this.currentRoleId);case 17:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),getAllRoles:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["R"])();case 2:t=e.sent,n=t.status,s=t.data,t.message,"OK"===n&&(this.roles=s.map(function(e){return{id:e.roleId,rolename:e.roleName,description:e.description,roleType:e.roleType,checked:!1,color:"success"}}));case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),menusResponseHandeler:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=[];return e.forEach(function(e){if(!e.parentId){var i=c["a"].find(function(t){return t.code===e.code});s.push(d({},e,{title:"zh-CN"===t.$lang?i.cnName:i.enName,id:e.id,expand:!0,checked:!1,children:[],disabled:n}))}}),e.forEach(function(e){if(e.parentId){var i=c["a"].find(function(t){return t.code===e.code});s.forEach(function(s){e.parentId===s.id&&s.children.push(d({},e,{title:"zh-CN"===t.$lang?i.cnName:i.enName,id:e.id,expand:!0,checked:!1,disabled:n}))})}}),s},getAllMenus:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["O"])();case 2:t=e.sent,n=t.status,s=t.data,t.message,"OK"===n&&(this.allMenusOriginResponse=s,this.menus=this.menusResponseHandeler(s),this.menusForEdit=this.menusResponseHandeler(s,!1));case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),permissionResponseHandeler:function(e){this.getPermissions(!0,!0,this.currentRoleId)},setPermissionAction:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n,s){var i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.currentRoleId){e.next=2;break}return e.abrupt("return");case 2:if(!t){e.next=9;break}return e.next=5,Object(o["a"])(this.currentRoleId,s,n);case 5:i=e.sent,this.permissionResponseHandeler(i),e.next=13;break;case 9:return e.next=11,Object(o["ic"])(this.currentRoleId,s,n);case 11:r=e.sent,this.permissionResponseHandeler(r);case 13:case"end":return e.stop()}},e,this)}));function t(t,n,s){return e.apply(this,arguments)}return t}(),getArrDifference:function(e,t){return e.concat(t).filter(function(e,t,n){return n.indexOf(e)===n.lastIndexOf(e)})},openUserManageModal:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.usersKeyBySelectedRole=[],this.allUsersForTransfer=[],this.selectedRole=t,e.next=5,Object(o["Pb"])(t);case 5:n=e.sent,s=n.status,i=n.data,n.message,"OK"===s&&(this.usersKeyBySelectedRole=i.map(function(e){return e.userId})),this.allUsersForTransfer=this.users.map(function(e){return{key:e.id,username:e.username,label:" ".concat(e.fullName," ( ").concat(e.description," ) ")}}),this.userManageModal=!0;case 12:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),cancel:function(){},confirmUser:function(){0!==this.currentRoleId&&this.handleRoleClick(!0,this.currentRoleId)}},created:function(){this.getAllUsers(),this.getAllRoles(),this.getAllMenus()},watch:{}},p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Row",[n("Col",{attrs:{span:"4"}},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n        用户\n        "),n("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:e.openAddUserModal}},[e._v("添加用户")])],1),e._v(" "),e._l(e.users,function(t){return n("Tag",{key:t.id,attrs:{name:t.username,color:t.color,checked:t.checked,checkable:"",fade:!1},on:{"on-change":e.handleUserClick}},[n("span",{attrs:{title:" "+t.fullName+" ( "+t.description+" ) "}},[e._v(e._s(" "+t.fullName+" ( "+t.description+" ) "))])])})],2)],1),e._v(" "),n("Col",{staticStyle:{"margin-left":"20px"},attrs:{span:"5",offset:"0"}},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n        角色\n        "),n("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:e.openAddRoleModal}},[e._v("添加角色")])],1),e._v(" "),e._l(e.roles,function(t){return n("div",{key:t.id,staticClass:"role-item"},[n("Tag",{attrs:{name:t.id,color:t.color,checked:t.checked,checkable:"",fade:!1},on:{"on-change":e.handleRoleClick}},[n("span",{attrs:{title:t.description}},[e._v(e._s(t.description))])]),e._v(" "),n("Button",{attrs:{icon:"ios-build",type:"dashed",size:"small"},on:{click:function(n){return e.openUserManageModal(t.id)}}},[e._v("用户")])],1)})],2)],1),e._v(" "),n("Col",{staticStyle:{"margin-left":"20px"},attrs:{span:"4",offset:"0"}},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("菜单权限")]),e._v(" "),n("Tree",{attrs:{data:e.menus,"show-checkbox":""},on:{"on-check-change":e.handleMenuTreeCheck}})],1)],1),e._v(" "),n("Col",{staticStyle:{"margin-left":"20px"},attrs:{span:"9",offset:"0"}},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("数据权限")]),e._v(" "),e._l(e.ciTypePermissions,function(t){return n("div",{key:t.ciTypeId,staticClass:"data-permissions"},[n("span",{staticClass:"ciTypes",staticStyle:{"max-width":"100px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},attrs:{title:t.ciTypeName}},[e._v(e._s(t.ciTypeName))]),e._v(" "),n("div",{staticClass:"ciTypes-options"},[e._l(e.actionsType,function(s){return n("Checkbox",{key:s.actionCode,attrs:{disabled:e.dataPermissionDisabled,indeterminate:"P"===t[s.actionCode],value:"Y"===t[s.actionCode]},nativeOn:{click:function(n){return n.preventDefault(),e.ciTypesPermissionsHandler(t,s.actionCode,s.type)}}},[e._v(e._s(s.actionName))])}),e._v(" "),n("Button",{attrs:{icon:"ios-build",type:"dashed",size:"small",disabled:e.dataPermissionDisabled},on:{click:function(n){return e.openPermissionManageModal(t.roleCiTypeId)}}},[e._v("详情")])],2)])})],2)],1),e._v(" "),n("Modal",{attrs:{title:"添加角色"},on:{"on-ok":e.addRole,"on-cancel":e.cancel},model:{value:e.addRoleModalVisible,callback:function(t){e.addRoleModalVisible=t},expression:"addRoleModalVisible"}},[n("Input",{attrs:{placeholder:"请输入用户名"},model:{value:e.addedRoleValue,callback:function(t){e.addedRoleValue=t},expression:"addedRoleValue"}})],1),e._v(" "),n("Modal",{attrs:{title:"添加用户"},on:{"on-ok":e.addUser,"on-cancel":e.cancel},model:{value:e.addUserModalVisible,callback:function(t){e.addUserModalVisible=t},expression:"addUserModalVisible"}},[n("Form",{ref:"addedUserForm",staticClass:"validation-form",attrs:{model:e.addedUser,"label-position":"left","label-width":100}},[n("FormItem",{attrs:{label:"用户名",prop:"username"}},[n("Input",{model:{value:e.addedUser.username,callback:function(t){e.$set(e.addedUser,"username",t)},expression:"addedUser.username"}})],1),e._v(" "),n("FormItem",{attrs:{label:"全名",prop:"fullName"}},[n("Input",{model:{value:e.addedUser.fullName,callback:function(t){e.$set(e.addedUser,"fullName",t)},expression:"addedUser.fullName"}})],1),e._v(" "),n("FormItem",{attrs:{label:"描述说明",prop:"description"}},[n("Input",{model:{value:e.addedUser.description,callback:function(t){e.$set(e.addedUser,"description",t)},expression:"addedUser.description"}})],1)],1)],1),e._v(" "),n("Modal",{attrs:{width:"700",title:"编辑用户"},on:{"on-ok":e.confirmUser,"on-cancel":e.confirmUser},model:{value:e.userManageModal,callback:function(t){e.userManageModal=t},expression:"userManageModal"}},[n("Transfer",{attrs:{titles:e.transferTitles,"list-style":e.transferStyle,data:e.allUsersForTransfer,"target-keys":e.usersKeyBySelectedRole,"render-format":e.renderUserNameForTransfer,filterable:""},on:{"on-change":e.handleUserTransferChange}})],1),e._v(" "),n("Modal",{attrs:{title:"编辑数据权限",width:"80"},on:{"on-ok":e.cancelEdit,"on-cancel":e.cancelEdit},model:{value:e.permissionManageModal,callback:function(t){e.permissionManageModal=t},expression:"permissionManageModal"}},[n("WeTable",{ref:"table",attrs:{tableData:e.ciTypeAttrsPermissions,filtersHidden:!0,tableOuterActions:e.outerActions,tableInnerActions:e.innerActions,tableColumns:e.attrsPermissionsColumns,ascOptions:e.permissionsTableOptions,showCheckbox:!0,tableHeight:"650"},on:{actionFun:e.actionFun,getSelectedRows:e.onSelectedRowsChange}})],1)],1)},f=[],m=n("2455");function h(e){n("7839")}var b=!1,v=h,y="data-v-671692c8",g=null,k=Object(m["a"])(u,p,f,b,v,y,g);t["default"]=k.exports}}]);
//# sourceMappingURL=chunk-7f557184.c2b1e0a6.js.map